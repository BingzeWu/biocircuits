{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 1. Introduction to biological circuit design\n",
    "\n",
    "<hr>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Key concepts**\n",
    "\n",
    "- Biological circuits:\n",
    "    - We focus on biological circuits, defined as sets of interacting molecular components that work together to control cellular behaviors.\n",
    "    - Circuit design principles relate a feature of a circuit to the function it provides for the cell. They often take the form *Feature X enables Function Y*.\n",
    "    - Design principles can help explain why circuits use one design or architecture instead of another.  \n",
    "    \n",
    "- Methods:\n",
    "    - Ordinary differential equations for protein production and removal allow analysis of simple gene expression processes.\n",
    "    - Separation of time scales simplifies circuit analysis.\n",
    "    - Gene regulation circuits can be analyzed in terms of binding of activators and repressors to binding sites.\n",
    "    - Demand theory relates the fraction of time a gene is expressed to its mode of regulation.\n",
    "    - Executable Jupyter notebooks (like this one) enable interactive exploration of key concepts.\n",
    "<hr>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "    <div class=\"bk-root\">\n",
       "        <a href=\"https://bokeh.org\" target=\"_blank\" class=\"bk-logo bk-logo-small bk-logo-notebook\"></a>\n",
       "        <span id=\"1002\">Loading BokehJS ...</span>\n",
       "    </div>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/javascript": [
       "\n",
       "(function(root) {\n",
       "  function now() {\n",
       "    return new Date();\n",
       "  }\n",
       "\n",
       "  const force = true;\n",
       "\n",
       "  if (typeof root._bokeh_onload_callbacks === \"undefined\" || force === true) {\n",
       "    root._bokeh_onload_callbacks = [];\n",
       "    root._bokeh_is_loading = undefined;\n",
       "  }\n",
       "\n",
       "  const JS_MIME_TYPE = 'application/javascript';\n",
       "  const HTML_MIME_TYPE = 'text/html';\n",
       "  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';\n",
       "  const CLASS_NAME = 'output_bokeh rendered_html';\n",
       "\n",
       "  /**\n",
       "   * Render data to the DOM node\n",
       "   */\n",
       "  function render(props, node) {\n",
       "    const script = document.createElement(\"script\");\n",
       "    node.appendChild(script);\n",
       "  }\n",
       "\n",
       "  /**\n",
       "   * Handle when an output is cleared or removed\n",
       "   */\n",
       "  function handleClearOutput(event, handle) {\n",
       "    const cell = handle.cell;\n",
       "\n",
       "    const id = cell.output_area._bokeh_element_id;\n",
       "    const server_id = cell.output_area._bokeh_server_id;\n",
       "    // Clean up Bokeh references\n",
       "    if (id != null && id in Bokeh.index) {\n",
       "      Bokeh.index[id].model.document.clear();\n",
       "      delete Bokeh.index[id];\n",
       "    }\n",
       "\n",
       "    if (server_id !== undefined) {\n",
       "      // Clean up Bokeh references\n",
       "      const cmd_clean = \"from bokeh.io.state import curstate; print(curstate().uuid_to_server['\" + server_id + \"'].get_sessions()[0].document.roots[0]._id)\";\n",
       "      cell.notebook.kernel.execute(cmd_clean, {\n",
       "        iopub: {\n",
       "          output: function(msg) {\n",
       "            const id = msg.content.text.trim();\n",
       "            if (id in Bokeh.index) {\n",
       "              Bokeh.index[id].model.document.clear();\n",
       "              delete Bokeh.index[id];\n",
       "            }\n",
       "          }\n",
       "        }\n",
       "      });\n",
       "      // Destroy server and session\n",
       "      const cmd_destroy = \"import bokeh.io.notebook as ion; ion.destroy_server('\" + server_id + \"')\";\n",
       "      cell.notebook.kernel.execute(cmd_destroy);\n",
       "    }\n",
       "  }\n",
       "\n",
       "  /**\n",
       "   * Handle when a new output is added\n",
       "   */\n",
       "  function handleAddOutput(event, handle) {\n",
       "    const output_area = handle.output_area;\n",
       "    const output = handle.output;\n",
       "\n",
       "    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only\n",
       "    if ((output.output_type != \"display_data\") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {\n",
       "      return\n",
       "    }\n",
       "\n",
       "    const toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]);\n",
       "\n",
       "    if (output.metadata[EXEC_MIME_TYPE][\"id\"] !== undefined) {\n",
       "      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];\n",
       "      // store reference to embed id on output_area\n",
       "      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE][\"id\"];\n",
       "    }\n",
       "    if (output.metadata[EXEC_MIME_TYPE][\"server_id\"] !== undefined) {\n",
       "      const bk_div = document.createElement(\"div\");\n",
       "      bk_div.innerHTML = output.data[HTML_MIME_TYPE];\n",
       "      const script_attrs = bk_div.children[0].attributes;\n",
       "      for (let i = 0; i < script_attrs.length; i++) {\n",
       "        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);\n",
       "        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent\n",
       "      }\n",
       "      // store reference to server id on output_area\n",
       "      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE][\"server_id\"];\n",
       "    }\n",
       "  }\n",
       "\n",
       "  function register_renderer(events, OutputArea) {\n",
       "\n",
       "    function append_mime(data, metadata, element) {\n",
       "      // create a DOM node to render to\n",
       "      const toinsert = this.create_output_subarea(\n",
       "        metadata,\n",
       "        CLASS_NAME,\n",
       "        EXEC_MIME_TYPE\n",
       "      );\n",
       "      this.keyboard_manager.register_events(toinsert);\n",
       "      // Render to node\n",
       "      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};\n",
       "      render(props, toinsert[toinsert.length - 1]);\n",
       "      element.append(toinsert);\n",
       "      return toinsert\n",
       "    }\n",
       "\n",
       "    /* Handle when an output is cleared or removed */\n",
       "    events.on('clear_output.CodeCell', handleClearOutput);\n",
       "    events.on('delete.Cell', handleClearOutput);\n",
       "\n",
       "    /* Handle when a new output is added */\n",
       "    events.on('output_added.OutputArea', handleAddOutput);\n",
       "\n",
       "    /**\n",
       "     * Register the mime type and append_mime function with output_area\n",
       "     */\n",
       "    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {\n",
       "      /* Is output safe? */\n",
       "      safe: true,\n",
       "      /* Index of renderer in `output_area.display_order` */\n",
       "      index: 0\n",
       "    });\n",
       "  }\n",
       "\n",
       "  // register the mime type if in Jupyter Notebook environment and previously unregistered\n",
       "  if (root.Jupyter !== undefined) {\n",
       "    const events = require('base/js/events');\n",
       "    const OutputArea = require('notebook/js/outputarea').OutputArea;\n",
       "\n",
       "    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {\n",
       "      register_renderer(events, OutputArea);\n",
       "    }\n",
       "  }\n",
       "\n",
       "  \n",
       "  if (typeof (root._bokeh_timeout) === \"undefined\" || force === true) {\n",
       "    root._bokeh_timeout = Date.now() + 5000;\n",
       "    root._bokeh_failed_load = false;\n",
       "  }\n",
       "\n",
       "  const NB_LOAD_WARNING = {'data': {'text/html':\n",
       "     \"<div style='background-color: #fdd'>\\n\"+\n",
       "     \"<p>\\n\"+\n",
       "     \"BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \\n\"+\n",
       "     \"may be due to a slow or bad network connection. Possible fixes:\\n\"+\n",
       "     \"</p>\\n\"+\n",
       "     \"<ul>\\n\"+\n",
       "     \"<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\\n\"+\n",
       "     \"<li>use INLINE resources instead, as so:</li>\\n\"+\n",
       "     \"</ul>\\n\"+\n",
       "     \"<code>\\n\"+\n",
       "     \"from bokeh.resources import INLINE\\n\"+\n",
       "     \"output_notebook(resources=INLINE)\\n\"+\n",
       "     \"</code>\\n\"+\n",
       "     \"</div>\"}};\n",
       "\n",
       "  function display_loaded() {\n",
       "    const el = document.getElementById(\"1002\");\n",
       "    if (el != null) {\n",
       "      el.textContent = \"BokehJS is loading...\";\n",
       "    }\n",
       "    if (root.Bokeh !== undefined) {\n",
       "      if (el != null) {\n",
       "        el.textContent = \"BokehJS \" + root.Bokeh.version + \" successfully loaded.\";\n",
       "      }\n",
       "    } else if (Date.now() < root._bokeh_timeout) {\n",
       "      setTimeout(display_loaded, 100)\n",
       "    }\n",
       "  }\n",
       "\n",
       "\n",
       "  function run_callbacks() {\n",
       "    try {\n",
       "      root._bokeh_onload_callbacks.forEach(function(callback) {\n",
       "        if (callback != null)\n",
       "          callback();\n",
       "      });\n",
       "    } finally {\n",
       "      delete root._bokeh_onload_callbacks\n",
       "    }\n",
       "    console.debug(\"Bokeh: all callbacks have finished\");\n",
       "  }\n",
       "\n",
       "  function load_libs(css_urls, js_urls, callback) {\n",
       "    if (css_urls == null) css_urls = [];\n",
       "    if (js_urls == null) js_urls = [];\n",
       "\n",
       "    root._bokeh_onload_callbacks.push(callback);\n",
       "    if (root._bokeh_is_loading > 0) {\n",
       "      console.debug(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n",
       "      return null;\n",
       "    }\n",
       "    if (js_urls == null || js_urls.length === 0) {\n",
       "      run_callbacks();\n",
       "      return null;\n",
       "    }\n",
       "    console.debug(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n",
       "    root._bokeh_is_loading = css_urls.length + js_urls.length;\n",
       "\n",
       "    function on_load() {\n",
       "      root._bokeh_is_loading--;\n",
       "      if (root._bokeh_is_loading === 0) {\n",
       "        console.debug(\"Bokeh: all BokehJS libraries/stylesheets loaded\");\n",
       "        run_callbacks()\n",
       "      }\n",
       "    }\n",
       "\n",
       "    function on_error(url) {\n",
       "      console.error(\"failed to load \" + url);\n",
       "    }\n",
       "\n",
       "    for (let i = 0; i < css_urls.length; i++) {\n",
       "      const url = css_urls[i];\n",
       "      const element = document.createElement(\"link\");\n",
       "      element.onload = on_load;\n",
       "      element.onerror = on_error.bind(null, url);\n",
       "      element.rel = \"stylesheet\";\n",
       "      element.type = \"text/css\";\n",
       "      element.href = url;\n",
       "      console.debug(\"Bokeh: injecting link tag for BokehJS stylesheet: \", url);\n",
       "      document.body.appendChild(element);\n",
       "    }\n",
       "\n",
       "    for (let i = 0; i < js_urls.length; i++) {\n",
       "      const url = js_urls[i];\n",
       "      const element = document.createElement('script');\n",
       "      element.onload = on_load;\n",
       "      element.onerror = on_error.bind(null, url);\n",
       "      element.async = false;\n",
       "      element.src = url;\n",
       "      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n",
       "      document.head.appendChild(element);\n",
       "    }\n",
       "  };\n",
       "\n",
       "  function inject_raw_css(css) {\n",
       "    const element = document.createElement(\"style\");\n",
       "    element.appendChild(document.createTextNode(css));\n",
       "    document.body.appendChild(element);\n",
       "  }\n",
       "\n",
       "  \n",
       "  const js_urls = [\"https://cdn.bokeh.org/bokeh/release/bokeh-2.4.2.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.2.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.2.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.2.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-2.4.2.min.js\"];\n",
       "  const css_urls = [];\n",
       "  \n",
       "\n",
       "  const inline_js = [\n",
       "    function(Bokeh) {\n",
       "      Bokeh.set_log_level(\"info\");\n",
       "    },\n",
       "    function(Bokeh) {\n",
       "    \n",
       "    \n",
       "    }\n",
       "  ];\n",
       "\n",
       "  function run_inline_js() {\n",
       "    \n",
       "    if (root.Bokeh !== undefined || force === true) {\n",
       "      \n",
       "    for (let i = 0; i < inline_js.length; i++) {\n",
       "      inline_js[i].call(root, root.Bokeh);\n",
       "    }\n",
       "    if (force === true) {\n",
       "        display_loaded();\n",
       "      }} else if (Date.now() < root._bokeh_timeout) {\n",
       "      setTimeout(run_inline_js, 100);\n",
       "    } else if (!root._bokeh_failed_load) {\n",
       "      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n",
       "      root._bokeh_failed_load = true;\n",
       "    } else if (force !== true) {\n",
       "      const cell = $(document.getElementById(\"1002\")).parents('.cell').data().cell;\n",
       "      cell.output_area.append_execute_result(NB_LOAD_WARNING)\n",
       "    }\n",
       "\n",
       "  }\n",
       "\n",
       "  if (root._bokeh_is_loading === 0) {\n",
       "    console.debug(\"Bokeh: BokehJS loaded, going straight to plotting\");\n",
       "    run_inline_js();\n",
       "  } else {\n",
       "    load_libs(css_urls, js_urls, function() {\n",
       "      console.debug(\"Bokeh: BokehJS plotting callback run at\", now());\n",
       "      run_inline_js();\n",
       "    });\n",
       "  }\n",
       "}(window));"
      ],
      "application/vnd.bokehjs_load.v0+json": "\n(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  const force = true;\n\n  if (typeof root._bokeh_onload_callbacks === \"undefined\" || force === true) {\n    root._bokeh_onload_callbacks = [];\n    root._bokeh_is_loading = undefined;\n  }\n\n  \n\n  \n  if (typeof (root._bokeh_timeout) === \"undefined\" || force === true) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  const NB_LOAD_WARNING = {'data': {'text/html':\n     \"<div style='background-color: #fdd'>\\n\"+\n     \"<p>\\n\"+\n     \"BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \\n\"+\n     \"may be due to a slow or bad network connection. Possible fixes:\\n\"+\n     \"</p>\\n\"+\n     \"<ul>\\n\"+\n     \"<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\\n\"+\n     \"<li>use INLINE resources instead, as so:</li>\\n\"+\n     \"</ul>\\n\"+\n     \"<code>\\n\"+\n     \"from bokeh.resources import INLINE\\n\"+\n     \"output_notebook(resources=INLINE)\\n\"+\n     \"</code>\\n\"+\n     \"</div>\"}};\n\n  function display_loaded() {\n    const el = document.getElementById(\"1002\");\n    if (el != null) {\n      el.textContent = \"BokehJS is loading...\";\n    }\n    if (root.Bokeh !== undefined) {\n      if (el != null) {\n        el.textContent = \"BokehJS \" + root.Bokeh.version + \" successfully loaded.\";\n      }\n    } else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(display_loaded, 100)\n    }\n  }\n\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) {\n        if (callback != null)\n          callback();\n      });\n    } finally {\n      delete root._bokeh_onload_callbacks\n    }\n    console.debug(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(css_urls, js_urls, callback) {\n    if (css_urls == null) css_urls = [];\n    if (js_urls == null) js_urls = [];\n\n    root._bokeh_onload_callbacks.push(callback);\n    if (root._bokeh_is_loading > 0) {\n      console.debug(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    }\n    if (js_urls == null || js_urls.length === 0) {\n      run_callbacks();\n      return null;\n    }\n    console.debug(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n    root._bokeh_is_loading = css_urls.length + js_urls.length;\n\n    function on_load() {\n      root._bokeh_is_loading--;\n      if (root._bokeh_is_loading === 0) {\n        console.debug(\"Bokeh: all BokehJS libraries/stylesheets loaded\");\n        run_callbacks()\n      }\n    }\n\n    function on_error(url) {\n      console.error(\"failed to load \" + url);\n    }\n\n    for (let i = 0; i < css_urls.length; i++) {\n      const url = css_urls[i];\n      const element = document.createElement(\"link\");\n      element.onload = on_load;\n      element.onerror = on_error.bind(null, url);\n      element.rel = \"stylesheet\";\n      element.type = \"text/css\";\n      element.href = url;\n      console.debug(\"Bokeh: injecting link tag for BokehJS stylesheet: \", url);\n      document.body.appendChild(element);\n    }\n\n    for (let i = 0; i < js_urls.length; i++) {\n      const url = js_urls[i];\n      const element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error.bind(null, url);\n      element.async = false;\n      element.src = url;\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n  };\n\n  function inject_raw_css(css) {\n    const element = document.createElement(\"style\");\n    element.appendChild(document.createTextNode(css));\n    document.body.appendChild(element);\n  }\n\n  \n  const js_urls = [\"https://cdn.bokeh.org/bokeh/release/bokeh-2.4.2.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.2.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.2.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.2.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-2.4.2.min.js\"];\n  const css_urls = [];\n  \n\n  const inline_js = [\n    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\n    function(Bokeh) {\n    \n    \n    }\n  ];\n\n  function run_inline_js() {\n    \n    if (root.Bokeh !== undefined || force === true) {\n      \n    for (let i = 0; i < inline_js.length; i++) {\n      inline_js[i].call(root, root.Bokeh);\n    }\n    if (force === true) {\n        display_loaded();\n      }} else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    } else if (force !== true) {\n      const cell = $(document.getElementById(\"1002\")).parents('.cell').data().cell;\n      cell.output_area.append_execute_result(NB_LOAD_WARNING)\n    }\n\n  }\n\n  if (root._bokeh_is_loading === 0) {\n    console.debug(\"Bokeh: BokehJS loaded, going straight to plotting\");\n    run_inline_js();\n  } else {\n    load_libs(css_urls, js_urls, function() {\n      console.debug(\"Bokeh: BokehJS plotting callback run at\", now());\n      run_inline_js();\n    });\n  }\n}(window));"
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Colab setup ------------------\n",
    "import os, sys, subprocess\n",
    "if \"google.colab\" in sys.modules:\n",
    "    cmd = \"pip install --upgrade watermark\"\n",
    "    process = subprocess.Popen(cmd.split(), stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n",
    "    stdout, stderr = process.communicate()\n",
    "# ------------------------------\n",
    "\n",
    "import numpy as np\n",
    "import bokeh.io\n",
    "import bokeh.plotting\n",
    "\n",
    "bokeh.io.output_notebook()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "tags": [
     "remove_cell"
    ]
   },
   "source": [
    "<hr>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Biological circuit design\n",
    "\n",
    "The living cell is a device unlike any other: It can sense its environment, search out nutrients, avoid threats, control its own division and growth, and keep track of time. Individual cells can switch into a variety of different states, coordinate with other cells to build complex multicellular tissues and organs (even brains!), develop into social organisms, and generate immune systems that can patrol those organisms to repair damage and destroy pathogens. Most of the time, they do these things reliably, with minimal external help, and without complaining. How are these incredible behaviors programmed within the cell? Can we understand these programs well enough to predict, control, or even reprogram cellular behaviors? \n",
    "\n",
    "This course seeks to establish key concepts, approaches, and examples that together provide a foundation for addressing these critical biological challenges. To do so, we focus on the **circuit** level. Circuits represent one of the most fascinating levels of cellular organization, midway between inanimate chemistry and a fully living cell. More specifically, we will analyze **molecular circuits** of interacting genes, proteins, and other biomolecules operating within cells, as well as **cell circuits** in which cell types interact through signals. As we explore different circuits, we will approach them from a **design** point of view, seeking to understand the tradeoffs among alternative desgins and suggest reasons for using one design rather than another.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Beyond molecular biology: \n",
    "\n",
    "Historically, the framework of molecular biology became dominant in the 1950s, with the central idea that we could understand biological phenomena in terms of the molecular structure and biochemical function of DNA, mRNA, and other molecules. (\"The Eighth Day of Creation\" by Horace Freeland Judson provides a riveting history of molecular biology.) Despite the focus on individual molecules, it was clear to the pioneers of molecular biology that all of these molecules functioned together in circuits. For example, in a 1962 essay, speaking about the organization of transcriptional regulatory systems, Jacob and Monod wrote, \n",
    "\n",
    "> It is obvious from the analysis of these [bacterial genetic regulatory] mechanisms that their known elements\n",
    "could be connected into a wide variety of ‘circuits’ endowed with any desired degree of stability. *Jacob F, Monod J, \"On the regulation of gene activity,\" Symposium on cellular regulatory mechanisms, 1962*. \n",
    "\n",
    "Around the 2000s, interest in the structure and function of circuits began to explode, fueled in part by new technologies that improved the ability to make quantitative, high-throughput measurements of biological systems. The new field took the name *systems biology*. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div style=\"width: 600px; margin: auto;\">\n",
    "\n",
    "![Hanahan and Weinberg](figs/Hanahan-Weinberg-2000.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "*This image of the cell as a set of circuits comes from a classic review of cancer ([Hanahan and Weinberg, _Cell_, 2000](https://doi.org/10.1016/S0092-8674%2800%2981683-9)).*\n",
    "\n",
    "<!-- Once Sphinx can handle percents in links, use DOI: https://doi.org/10.1016/S0092-8674%2800%2981683-9 -->\n",
    "\n",
    "<!-- Link to reader: https://reader.elsevier.com/reader/sd/pii/S0092867400816839?token=0484E13D03429AA97AEB30B7F31F6FA354F58B5084EC65AAD2F7378F8799578FA1A1D3336D1FB292B5CE9FFA10DF5359. -->"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### What is a biological circuit?\n",
    "\n",
    "For this course, we will think about at least two levels of biological circuitry: \n",
    "\n",
    "**Molecular circuits**  consist of molecular species (genes, proteins, etc.) that interact with one another in specific ways. For example, a given gene can be transcribed to produce a corresponding mRNA, which can in turn be translated to produce a specific protein. That protein may be a repressor that turns off expression of a different gene, or even its own gene. Similarly, a kinase may phosphorylate a specific target protein, altering its ability to catalyze a reaction or modify another protein. The molecular specificity of these interactions—analogous to wires in electronics—is the key property that enables them to form molecular circuits. \n",
    "\n",
    "One level up, we will also consider **cell circuits**. In this case, cells in different states, of different types, or even from different species signal to one another to control each other's growth, death, proliferation, and differentiation. The key variables in these circuits are the population sizes and spatial arrangements of each type of cell. For example, the immune system, in which different cell types influence each other's proliferation and differentiation through cytokines and other signals, represents a collection of complex, interconnected cell circuits.\n",
    "\n",
    "The two levels are not independent. The behavior of each cell type within a cell circuit is determined by the structure of its  molecular circuits. \n",
    "\n",
    "At either level, we can also distinguish between ***natural* circuits** and ***synthetic* circuits.** The former are discovered in microbes, plants, and animals, while the latter are designed and engineered in cells out of well-characterized, re-engineered, or de novo designed genes, proteins, and other molecular components. Here, we take the point of view that natural and synthetic circuits, despite their different origins, should share a common set of design principles, many yet to be discovered. Treating them in a unified way is helpful, because natural circuits can provide design inspiration for synthetic circuits, while the process of engineering synthetic circuits can provoke unexpected questions about natural circuits. \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Biological circuit design\n",
    "\n",
    "**Design problems** emerge whenever one can build many different products from arrangements of the same elements. Electronic circuits are composed of a handful of different kinds of elements: transistors, resisters, capacitors, etc. that can be connected in different ways to produce circuits with different properties. Design requires comparing different circuit designs that may appear to perform similar functions, but in fact exhibit different tradeoffs, e.g. between power and performance, or speed and precision. Design problems are also prevalent outside of science and engineering. For example, to make a movie poster one has to choose and arrange graphical elements in relation to one another. \n",
    "\n",
    "We now have much information about the molecular components of cells (genes, RNAs, proteins, metabolites, and many other molecules) and their interactions. In many cases, we know the sites at which transcription factors bind genome-wide, which proteins chemically modify which others, and which proteins function together in complexes. It might seem as if we ought to already be able to understand, predict, and control cellular circuits with great precision. However, fundamental questions about the designs of these circuits still remain unclear. For example:\n",
    "\n",
    "* What capabilities does each circuit provide for the cell? (function, design principles)\n",
    "* How do these capabilities emerge from circuit architecture? (mechanism)\n",
    "* How can we control cells in predictable ways using these circuits? (biomedical applications)\n",
    "* How can we use circuit design principles to program predictable new behaviors in living cells? (synthetic biology and bioengineering)\n",
    "\n",
    "In this course, we will address these questions for both *natural* and *synthetic* circuits, with the idea that the principles that allow a circuit to function effectively within or among cells do not necessarily depend on whether that circuit evolved naturally or is constructed in the lab. Having said that, we also recognize that evolution may be able to produce designs that are more complex or different from those we are currently able to construct, or even conceive. In fact, a major goal of the course is to see to what extent we can learn principles from natural circuits that will allow us to design synthetic circuits more effectively.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div style=\"width: 600px; margin: auto;\">\n",
    "\n",
    "![electronics and plumbing](figs/electronics_software_plumbing.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "*Electronics, software, and plumbing are great examples of human-designed systems that possess many properties analogous to biological circuits. These systems are based on known design principles that sometimes overlap with, and sometimes differ from, those of biological circuits. Plumbing picture by flickr user frozen-tundra, [CC-BY-2.0 licensed](https://creativecommons.org/licenses/by/2.0/deed.en).*"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Biological circuits differ from many other types of circuits or circuit-like systems\n",
    "\n",
    "Is biological circuit design a solved problem? Electronics, software, plumbing, construction, and other human designed systems are based on connections between modular components (see Figure). Can we not just apply known principles of those systems biological circuits? The answer is generally \"no,\" or \"only a little,\" because biological systems differ in fundamental ways from these systems:\n",
    "\n",
    "* Natural circuits were not designed by people. They evolved. That means they are not \"well-documented\" and their function(s) are often totally unclear.\n",
    "* Even synthetic circuits, which are designed by people, often use evolved components (such as transcription factors) that we do not fully understand.\n",
    "* Biological circuits use fundamentally different designs than human-engineered counterparts. For example, in cells, molecular components exhibit extensive many-to-many interactions (\"crosstalk\") among their components. This property is typically avoided in electronics but may provide unique capabilities to cells.\n",
    "* Noise: While electronic circuits can function deterministically, biological circuits  function with high levels of stochastic (random) fluctuations in their own components. These fluctuations are often called \"noise.\" And noise is not just a nuisance: some biological circuits take advantage of it to enable behaviors that would not be possible without it.\n",
    "* Biological circuits use parallelism: The same circuit can operate in many different genetically identical individual cells, whether in a bacterial population or in a multicellular organism.\n",
    "* Electrical systems use positive or negative voltages and currents, allowing for positive or negative effects. By contrast, biological circuits are built out of molecules (or cells) whose concentrations cannot be negative. That means they must use other mechanisms for \"inverting\" activities.\n",
    "* From a more practical point of view, we have a very limited ability to construct, test, and compare designs. Even with recent developments such as CRISPR, our ability to rapidly and precisely produce cells with well-defined genomes remains limited compared to what is possible in more advanced disciplines. (This situation is rapidly improving!)\n",
    "* *What other fundamental differences between biological circuits and human designed systems can you think of?* "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Inspiration from electronics\n",
    "\n",
    "In their classic book, [*The Art of Electronics*](https://artofelectronics.net), 3rd Ed., Horowitz and Hill explain something similar to the excitement many now feel now about biological circuit design.\n",
    "\n",
    ">The field of electronics is one of the great success stories of the 20th century. From the crude spark-gap transmitters and \"cat's-whisker\" detectors at its beginning, the first half-century brought an era of vacuum-tube electronics that developed considerable sophistication and found ready application in areas such as communications, navigation, instrumentation, control, and computation. The latter half-century brought \"solid-state\" electronics — first as discrete transistors, then as magnificent arrays of them within \"integrated circuits\" (ICs) — in a flood of stunning advances that shows no sign of abating. Compact and inexpensive consumer products now routinely contain many millions of transistors in VLSI (very large-scale integration) chips, combined with elegant optoelectronics (displays, lasers, and so on); they can process sounds, images, and data, and (for example) permit wireless networking and shirt-pocket access to the pooled capabilities of the Internet. Perhaps as noteworthy is the pleasant trend toward increased performance per dollar. The cost of an electronic microcircuit routinely decreases to a fraction of its initial cost as the manufacturing process is perfected....\n",
    ">\n",
    ">On reading of these exciting new developments in electronics, you may get the impression that you should be able to construct powerful, elegant, yet inexpensive, little gadgets to do almost any conceivable task — all you need to know is how all these miracle devices work.\n",
    "\n",
    "Indeed, the marvelous progression of electronic circuit capabilities they describe could well describe biological circuits decades from now. Like electronics, we may will soon be able to construct \"gadgets\" using biological materials to do myriad tasks. Our goal in this book is to help you know how the \"miracle devices,\" the components of biological circuits and the emergent properties thereof when they are \"wired\" together, work."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Premise and goals\n",
    "\n",
    "This book explores foundational concepts needed to understand, predict, and control living systems with greater precision (systems biology), and to design synthetic circuits that provide new functions (synthetic biology). We will develop quantitative approaches for analyzing different circuit designs (tools), and also identify circuit design principles that provide insight and intuition into how different designs operate, and why they were selected by evolution or synthetic biologists. \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Design principles relate circuit features to circuit functions\n",
    "\n",
    "We will define a circuit **design principle** as a statement of the form: *Circuit feature X enables function Y*. Each module of the course will explore a different design principle. Here are some examples:\n",
    "\n",
    "* Negative autoregulation of a transcription factor accelerates its response to a change in input.\n",
    "* Kinases that also act as phosphatases (bifunctional kinases) provide tunable linear amplifiers in two-component signaling systems.\n",
    "* Pulsing a transcription factor on and off at different frequencies (time-based regulation) can enable coordinated regulation of many target genes.\n",
    "* Noise-excitable circuits enable cells to control the probability of transiently differentiating into an alternate state.\n",
    "* Mutual inactivation of receptors and ligands in the same cell enable equivalent cells to signal unidirectionally.\n",
    "* Independent tuning of gene expression burst size and frequency enables cells to control cell-cell heterogeneity in gene expression.\n",
    "* Feedback on morphogen mobility allows tissue patterns to scale with the size of a tissue"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Developing intuition: analzying the simplest gene regulation circuits\n",
    "\n",
    "We will start with the simplest possible \"circuit\"—hardly a circuit at all, really, just a single gene—coding for a single corresponding protein. This minimal example will allow us to develop intuition for the dynamics of the simplest gene regulation systems and lay out a procedure that we can further extend to analyze more complex circuits. \n",
    "\n",
    "How much protein will the gene *x* produce? We assume that the gene will be transcribed to mRNA and those mRNA molecules will in turn be translated to produce proteins, such that new proteins are produced at a total rate $\\beta$ molecules per unit time. The $x$ protein does not simply accumulate over time. It is also removed both through active degradation as well as dilution as cells grow and divide. For simplicity, we will assume that both processes tend to reduce protein concentrations through a simple first-order process, with a rate constant $\\gamma$. \n",
    "\n",
    "The approach we are taking can be described as \"phenomenological modeling.\" We do not explicitly represent every underlying molecular step. Instead, we assume those steps give rise to \"coarse grained\" relationships that we can model in a manner that is independent of many underlying molecular details. The test of this approach is whether it allows us to understand and experimentally predict the behavior of real biological systems. See [Wikipedia's article on phenomenological models](https://en.wikipedia.org/wiki/Phenomenological_model) and [this article](https://doi.org/10.1186/1741-7007-12-29) by Jeremy Gunawardena for insights and commentary.\n",
    "\n",
    "Thus, we can draw a diagram of our simple gene, *x*, with its protein being produced and removed (dashed circle):\n",
    "\n",
    "<div style=\"width: 250px; margin: auto;\">\n",
    "\n",
    "![simplest_protein](figs/simplest_protein.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "Here, protein production occurs at rate $\\beta$ and degradation+dilution at rate $\\gamma x$. We can then write down a simple ordinary differential equation describing these dynamics:\n",
    "\n",
    "\\begin{align} \n",
    "&\\frac{dx}{dt} = \\mathrm{production - (degradation+dilution)} \\\\[1em]\n",
    "&\\frac{dx}{dt} = \\beta - \\gamma x\n",
    "\\end{align}\n",
    "\n",
    "where \n",
    "\n",
    "\\begin{align}\n",
    "\\gamma = \\gamma_\\mathrm{dilution} + \\gamma_\\mathrm{degradation}\n",
    "\\end{align}\n",
    "\n",
    "*A note on effective degradation rates*: When cells are growing, protein is removed through both  degradation and dilution. For stable proteins, dilution dominates. For very unstable proteins, whose half-life is much smaller than the cell cycle period, dilution may be negligible. In bacteria, mRNA half-lives (1-10 min, typically) are much shorter than protein half-lives. In eukaryotic cells this is not necessarily true (mRNA half-lives can be many hours in mammalian cells)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Solving for the steady state\n",
    "\n",
    "Often, one of the first things we would like to know is the concentration of protein under steady state conditions. To obtain this, we set the time derivative to 0, and solve:\n",
    "\n",
    "\\begin{align}\n",
    "&\\frac{dx}{dt} = \\beta - \\gamma x = 0 \\\\[1em]\n",
    "&\\Rightarrow x_\\mathrm{ss} = \\beta / \\gamma \n",
    "\\end{align}\n",
    "\n",
    "In other words, the steady-state protein concentration depends on the ratio of production rate to degradation rate."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Including transcription and translation as separate steps \n",
    "\n",
    "This description does not distinguish between transcription and translation. However, considering both processes separately can be important in the more dynamic and stochastic contexts that we will encounter later in the course. To do so, we can simply add an additional variable to represent the mRNA concentration, which is now transcribed, translated to protein, and degraded (and diluted), as shown schematically here:\n",
    "\n",
    "<div style=\"width: 350px; margin: auto;\">\n",
    "\n",
    "![transcript_and_translation](figs/transcription_and_translation.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "These reactions can be described by two coupled differential equations for the mRNA ($m$) and protein ($x$) concentrations\n",
    ":\n",
    "\n",
    "\\begin{align}\n",
    "&\\frac{dm}{dt} = \\beta_m - \\gamma_m m, \\\\[1em]\n",
    "&\\frac{dx}{dt} = \\beta_p m - \\gamma_p x. \n",
    "\\end{align}\n",
    "\n",
    "Now, we can  determine the steady state mRNA and protein concentrations straightforwardly, by setting both time derivatives to 0 and solving. We find:\n",
    "\n",
    "\\begin{align}\n",
    "&m_\\mathrm{ss} = \\beta_m / \\gamma_m, \\\\[1em]\n",
    "&x_\\mathrm{ss} = \\frac{\\beta_p m_\\mathrm{ss}}{\\gamma_p} = \\frac{\\beta_p \\beta_m}{\\gamma_p \\gamma_m}.\n",
    "\\end{align}\n",
    "\n",
    "From this, we see that the steady state protein concentration is proportional to the product of the two synthesis rates and inversely proportional to the product of the two degradation rates. \n",
    "\n",
    "And this gives us our first **design puzzle**, which you can explore in an end-of-chapter problem: The cell could control protein expression level in at least four different ways. It could modulate (1) transcription, (2) translation, (3) mRNA degradation, or (4) protein degradation rates, or combinations thereof. Are there tradeoffs between these different options? Are they all used indiscriminately or is one favored in natural contexts? "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## From gene expression to gene regulation: Adding a repressor\n",
    "\n",
    "In principle, genes could be left \"on\" all the time. In actuality, the cell activity regulates them, turning their expression levels lower or higher depending on environmental conditions and cellular state. **Repressors** provide a key mechanism for regulation. Repressors are proteins that bind to cognate specific sequences at or near a promoter, to change its expression. Often the strength of repressor binding depends on external inputs. For example, the LacI repressor normally turns off the genes for lactose utilization in *E. coli*. However, in the presence of lactose in the media, a modified form of lactose binds to LacI, inhibiting its ability to repress its target genes. Thus, a nutrient (lactose) can regulate expression of genes that allow the cell to use it. (The book [*The lac Operon*](https://doi.org/10.1515/9783110879476) by B. Müller-Hill provides the fascinating scientific and historical saga of this iconic system.)\n",
    "\n",
    "In the following diagram, we label the repressor R.\n",
    "\n",
    "<div style=\"width: 450px; margin: auto;\">\n",
    "\n",
    "![repressible_gene_2](figs/repressible_gene2.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "\n",
    "Within the cell, the repressor binds and unbinds its target site. We assume that the expression level of the gene is lower when the repressor is bound and higher when it is unbound. The mean expression level of the gene is then proportional to the fraction of time that the promoter region is not bound with a repressor.\n",
    "\n",
    "The process of binding and unbinding of a repressor can be represented as the chemical reaction\n",
    "\n",
    "\\begin{align}\n",
    "\\require{mhchem}\n",
    "\\ce{P + R <=>[k_+][k_-] P}_\\mathrm{occ}.\n",
    "\\end{align}\n",
    "\n",
    "We can model the dynamics of this chemical reaction using **mass action kinetics** in which the rate of a reaction is proportional to the product of the concentrations of its reactants. We therefore represent the \"concentration\" of target sites in occupied or unoccupied states. Within a single cell an individual site on the DNA is either bound or unbound, but averaged over a population of cells, we can talk about the mean occupancy of the site. Let $r$ be the concentration of repressor, $p$ be the concentration of unoccupied promoter, $p_\\mathrm{occ}$ be the concentration of promoter occupied by a repressor. Then,\n",
    "\n",
    "\\begin{align}\n",
    "\\frac{\\mathrm{d}p}{\\mathrm{d}t} = -k_+\\,p\\,r + k_- p_\\mathrm{occ}.\n",
    "\\end{align}\n",
    "\n",
    "We can assume a **separation of timescales** between the rates of binding and unbinding of the repressor to the DNA binding site are both often fast compared to the timescales over which mRNA and protein concentrations vary. (Be careful applying this assumption; in some contexts, such as mammalian cells, it is not true.) Then, on the time scale of variation in mRNA and protein concentrations, the repressor-promoter binding-unbinding reaction dynamics are fast and the reaction is essentially at steady state such that $\\mathrm{d}p/\\mathrm{d}t \\approx 0$, giving\n",
    "\n",
    "\\begin{align}\n",
    "-k_+\\,p\\,r + k_- p_\\mathrm{occ} = 0.\n",
    "\\end{align}\n",
    "\n",
    "If $p_\\mathrm{tot}$ is the total concentration of promoters, occupied or not, then $p_\\mathrm{tot} = p + p_\\mathrm{occ}$, and we have\n",
    "\n",
    "\\begin{align}\n",
    "-k_+\\,p\\,r + k_- (p_\\mathrm{tot} - p) = 0,\n",
    "\\end{align}\n",
    "\n",
    "which can be rearranged to give the fraction of promoters that are free to allow transcription,\n",
    "\n",
    "\\begin{align}\n",
    "\\frac{p}{p_\\mathrm{tot}} = \\frac{1}{1+r/K_\\mathrm{d}},\n",
    "\\end{align}\n",
    "\n",
    "where we have defined the **dissociation constant** for repressor-target binding\n",
    "\n",
    "\\begin{align}\n",
    "K_\\mathrm{d} = \\frac{k_-}{k_+}\n",
    "\\end{align}\n",
    "\n",
    "Because we have a separation of time scales, the rate of production of gene product should be proportional to the probability of the promoter being unbound,\n",
    "\n",
    "\\begin{align}\n",
    "\\beta(r) = \\beta_0 \\frac{p}{p_\\mathrm{tot}} = \\frac{\\beta_0}{1+r/K_\\mathrm{d}}.\n",
    "\\end{align}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Properties of the simple binding curve\n",
    "\n",
    "This is our first encounter with a soon to be familiar function. Note that this function has two parameters: $K_\\mathrm{d}$ specifies the concentration of repressor at which the response is reduced to half its maximum value. The coefficient $\\beta_0$ is simply the maximum expression level, and is a parameter that multiples the rest of the function. Also notice that for small values of $r$, the slope is $1/K_d$ "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "  <div class=\"bk-root\" id=\"340407f5-7af2-48b6-bfe4-897e389cb0f3\" data-root-id=\"1003\"></div>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/javascript": [
       "(function(root) {\n",
       "  function embed_document(root) {\n",
       "    \n",
       "  const docs_json = {\"edd4d6c9-cdc4-4439-b6be-02f845919ef3\":{\"defs\":[],\"roots\":{\"references\":[{\"attributes\":{\"below\":[{\"id\":\"1012\"}],\"center\":[{\"id\":\"1015\"},{\"id\":\"1019\"},{\"id\":\"1051\"}],\"frame_height\":225,\"frame_width\":350,\"left\":[{\"id\":\"1016\"}],\"renderers\":[{\"id\":\"1038\"},{\"id\":\"1057\"}],\"title\":{\"id\":\"1040\"},\"toolbar\":{\"id\":\"1027\"},\"x_range\":{\"id\":\"1004\"},\"x_scale\":{\"id\":\"1008\"},\"y_range\":{\"id\":\"1006\"},\"y_scale\":{\"id\":\"1010\"}},\"id\":\"1003\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"coordinates\":null,\"group\":null},\"id\":\"1040\",\"type\":\"Title\"},{\"attributes\":{\"source\":{\"id\":\"1034\"}},\"id\":\"1039\",\"type\":\"CDSView\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"orange\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1037\",\"type\":\"Line\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"orange\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1036\",\"type\":\"Line\"},{\"attributes\":{\"end\":20.0},\"id\":\"1004\",\"type\":\"Range1d\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"AAAAAAAA8D9wD2z0rsjsP+Ae2Ohdkek/UC5E3Qxa5j/APbDRuyLjP16aOIzV1t8/PrkQdTNo2T8e2OhdkfnSP/ztgY3eFck/eFdkvjRxuD8A0bLjOZV0v5Cx2vrbA7u/CBu9KzJfyr+kbgYtO57Tv8RPLkTdDNq/chirrb894L8CCT+5EHXjv5L50sRhrOa/Iupm0LLj6b+y2vrbAxvtv6Jlx3MqKfC/6l2R+dLE8b8yVlt/e2Dzv3pOJQUk/PS/wkbvisyX9r8KP7kQdTP4v1I3g5Ydz/m/mi9NHMZq+7/iJxeibgb9vyog4ScXov6/OYzV1t8eAMBdiLoZtOwAwIGEn1yIugHApYCEn1yIAsDJfGniMFYDwO14TiUFJATAEXUzaNnxBMA1cRirrb8FwFlt/e2BjQbAfWniMFZbB8CiZcdzKikIwMZhrLb+9gjA6l2R+dLECcAOWnY8p5IKwDJWW397YAvAVlJAwk8uDMB6TiUFJPwMwJ5KCkj4yQ3AwkbvisyXDsDmQtTNoGUPwIWfXIi6GRDAlx3PqaSAEMCpm0HLjucQwLsZtOx4ThHAzZcmDmO1EcDfFZkvTRwSwPGTC1E3gxLAAxJ+ciHqEsAVkPCTC1ETwCcOY7X1txPAOYzV1t8eFMBLCkj4yYUUwF2Iuhm07BTAbwYtO55TFcCBhJ9ciLoVwJMCEn5yIRbApYCEn1yIFsC3/vbARu8WwMl8aeIwVhfA2/rbAxu9F8DteE4lBSQYwP/2wEbvihjAEXUzaNnxGMAj86WJw1gZwDVxGKutvxnAR++KzJcmGsBZbf3tgY0awGvrbw9s9BrAfWniMFZbG8CP51RSQMIbwKJlx3MqKRzAtOM5lRSQHMDGYay2/vYcwNjfHtjoXR3A6l2R+dLEHcD82wMbvSsewA5adjynkh7AINjoXZH5HsAyVlt/e2AfwETUzaBlxx/AKykg4ScXIMA0aNnxnEogwD2nkgISfiDARuZLE4exIMBPJQUk/OQgwFhkvjRxGCHAYaN3ReZLIcBq4jBWW38hwHMh6mbQsiHAfGCjd0XmIcCFn1yIuhkiwI7eFZkvTSLAlx3PqaSAIsCgXIi6GbQiwKmbQcuO5yLAstr62wMbI8C7GbTseE4jwMRYbf3tgSPAzZcmDmO1I8DW1t8e2OgjwN8VmS9NHCTA6FRSQMJPJMDxkwtRN4MkwPrSxGGstiTAAxJ+ciHqJMAMUTeDlh0lwBWQ8JMLUSXAHs+ppICEJcAnDmO19bclwDBNHMZq6yXAOYzV1t8eJsBCy47nVFImwEsKSPjJhSbAVEkBCT+5JsBdiLoZtOwmwGbHcyopICfAbwYtO55TJ8B4ReZLE4cnwIGEn1yIuifAisNYbf3tJ8CTAhJ+ciEowJxBy47nVCjApYCEn1yIKMCuvz2w0bsowLf+9sBG7yjAwD2w0bsiKcDJfGniMFYpwNK7IvOliSnA2/rbAxu9KcDkOZUUkPApwO14TiUFJCrA9rcHNnpXKsD/9sBG74oqwAg2eldkvirAEXUzaNnxKsAatOx4TiUrwCPzpYnDWCvALDJfmjiMK8A1cRirrb8rwD6w0bsi8yvAR++KzJcmLMBQLkTdDFoswFlt/e2BjSzAYqy2/vbALMBr628PbPQswHQqKSDhJy3AfWniMFZbLcCGqJtBy44twI/nVFJAwi3AmCYOY7X1LcCiZcdzKikuwKqkgISfXC7AtOM5lRSQLsC8IvOlicMuwMZhrLb+9i7AzqBlx3MqL8DY3x7Y6F0vwOAe2OhdkS/A6l2R+dLEL8DynEoKSPgvwP7tgY3eFTDAgo3eFZkvMMAHLTueU0kwwIvMlyYOYzDAEGz0rsh8MMCUC1E3g5YwwBmrrb89sDDAnUoKSPjJMMAi6mbQsuMwwKaJw1ht/TDAKykg4ScXMcCvyHxp4jAxwDRo2fGcSjHAuAc2eldkMcA9p5ICEn4xwMFG74rMlzHARuZLE4exMcDKhaibQcsxwE8lBST85DHA08RhrLb+McBYZL40cRgywNwDG70rMjLAYaN3ReZLMsDlQtTNoGUywGriMFZbfzLA7oGN3hWZMsBzIepm0LIywPfARu+KzDLAfGCjd0XmMsAAAAAAAAAzwA==\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1049\"},\"selection_policy\":{\"id\":\"1048\"}},\"id\":\"1034\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"1043\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"axis_label\":\"\\u03b2(r)\\u2215\\u03b2\\u2080\",\"coordinates\":null,\"formatter\":{\"id\":\"1043\"},\"group\":null,\"major_label_policy\":{\"id\":\"1044\"},\"ticker\":{\"id\":\"1017\"}},\"id\":\"1016\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"1021\",\"type\":\"WheelZoomTool\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1053\"},\"glyph\":{\"id\":\"1054\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1056\"},\"nonselection_glyph\":{\"id\":\"1055\"},\"view\":{\"id\":\"1058\"}},\"id\":\"1057\",\"type\":\"GlyphRenderer\"},{\"attributes\":{},\"id\":\"1008\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"1044\",\"type\":\"AllLabels\"},{\"attributes\":{\"axis\":{\"id\":\"1016\"},\"coordinates\":null,\"dimension\":1,\"group\":null,\"ticker\":null},\"id\":\"1019\",\"type\":\"Grid\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"AAAAAAAAAACBhJ9ciLq5P4GEn1yIusk/YaN3ReZL0z+BhJ9ciLrZP9Gy4zmVFOA/YaN3ReZL4z/xkwtRN4PmP4GEn1yIuuk/EXUzaNnx7D/RsuM5lRTwPxmrrb89sPE/YaN3ReZL8z+pm0HLjuf0P/GTC1E3g/Y/OYzV1t8e+D+BhJ9ciLr5P8l8aeIwVvs/EXUzaNnx/D9Zbf3tgY3+P9Gy4zmVFABA9a7IfGniAEAZq62/PbABQD2nkgISfgJAYaN3ReZLA0CFn1yIuhkEQKmbQcuO5wRAzZcmDmO1BUDxkwtRN4MGQBWQ8JMLUQdAOYzV1t8eCEBdiLoZtOwIQIGEn1yIuglApYCEn1yICkDJfGniMFYLQO14TiUFJAxAEXUzaNnxDEA1cRirrb8NQFlt/e2BjQ5AfWniMFZbD0DRsuM5lRQQQOMwVlt/exBA9a7IfGniEEAHLTueU0kRQBmrrb89sBFAKykg4ScXEkA9p5ICEn4SQE8lBST85BJAYaN3ReZLE0BzIepm0LITQIWfXIi6GRRAlx3PqaSAFECpm0HLjucUQLsZtOx4ThVAzZcmDmO1FUDfFZkvTRwWQPGTC1E3gxZAAxJ+ciHqFkAVkPCTC1EXQCcOY7X1txdAOYzV1t8eGEBLCkj4yYUYQF2Iuhm07BhAbwYtO55TGUCBhJ9ciLoZQJMCEn5yIRpApYCEn1yIGkC3/vbARu8aQMl8aeIwVhtA2/rbAxu9G0DteE4lBSQcQP/2wEbvihxAEXUzaNnxHEAj86WJw1gdQDVxGKutvx1AR++KzJcmHkBZbf3tgY0eQGvrbw9s9B5AfWniMFZbH0CP51RSQMIfQNGy4zmVFCBA2vGcSgpIIEDjMFZbf3sgQOxvD2z0riBA9a7IfGniIED+7YGN3hUhQActO55TSSFAEGz0rsh8IUAZq62/PbAhQCLqZtCy4yFAKykg4ScXIkA0aNnxnEoiQD2nkgISfiJARuZLE4exIkBPJQUk/OQiQFhkvjRxGCNAYaN3ReZLI0Bq4jBWW38jQHMh6mbQsiNAfGCjd0XmI0CFn1yIuhkkQI7eFZkvTSRAlx3PqaSAJECgXIi6GbQkQKmbQcuO5yRAstr62wMbJUC7GbTseE4lQMRYbf3tgSVAzZcmDmO1JUDW1t8e2OglQN8VmS9NHCZA6FRSQMJPJkDxkwtRN4MmQPrSxGGstiZAAxJ+ciHqJkAMUTeDlh0nQBWQ8JMLUSdAHs+ppICEJ0AnDmO19bcnQDBNHMZq6ydAOYzV1t8eKEBCy47nVFIoQEsKSPjJhShAVEkBCT+5KEBdiLoZtOwoQGbHcyopIClAbwYtO55TKUB4ReZLE4cpQIGEn1yIuilAisNYbf3tKUCTAhJ+ciEqQJxBy47nVCpApYCEn1yIKkCuvz2w0bsqQLf+9sBG7ypAwD2w0bsiK0DJfGniMFYrQNK7IvOliStA2/rbAxu9K0DkOZUUkPArQO14TiUFJCxA9rcHNnpXLED/9sBG74osQAg2eldkvixAEXUzaNnxLEAatOx4TiUtQCPzpYnDWC1ALDJfmjiMLUA1cRirrb8tQD6w0bsi8y1AR++KzJcmLkBQLkTdDFouQFlt/e2BjS5AYqy2/vbALkBr628PbPQuQHQqKSDhJy9AfWniMFZbL0CGqJtBy44vQI/nVFJAwi9AmCYOY7X1L0DRsuM5lRQwQFVSQMJPLjBA2vGcSgpIMEBekfnSxGEwQOMwVlt/ezBAZ9Cy4zmVMEDsbw9s9K4wQHAPbPSuyDBA9a7IfGniMEB5TiUFJPwwQP7tgY3eFTFAgo3eFZkvMUAHLTueU0kxQIvMlyYOYzFAEGz0rsh8MUCUC1E3g5YxQBmrrb89sDFAnUoKSPjJMUAi6mbQsuMxQKaJw1ht/TFAKykg4ScXMkCvyHxp4jAyQDRo2fGcSjJAuAc2eldkMkA9p5ICEn4yQMFG74rMlzJARuZLE4exMkDKhaibQcsyQE8lBST85DJA08RhrLb+MkBYZL40cRgzQNwDG70rMjNAYaN3ReZLM0DlQtTNoGUzQGriMFZbfzNA7oGN3hWZM0BzIepm0LIzQPfARu+KzDNAfGCjd0XmM0AAAAAAAAA0QA==\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1070\"},\"selection_policy\":{\"id\":\"1069\"}},\"id\":\"1053\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"1010\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"1017\",\"type\":\"BasicTicker\"},{\"attributes\":{},\"id\":\"1046\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"1006\",\"type\":\"Range1d\"},{\"attributes\":{\"click_policy\":\"hide\",\"coordinates\":null,\"group\":null,\"items\":[{\"id\":\"1072\"},{\"id\":\"1052\"}]},\"id\":\"1051\",\"type\":\"Legend\"},{\"attributes\":{\"source\":{\"id\":\"1053\"}},\"id\":\"1058\",\"type\":\"CDSView\"},{\"attributes\":{\"axis_label\":\"r\\u2215Kd\",\"coordinates\":null,\"formatter\":{\"id\":\"1046\"},\"group\":null,\"major_label_policy\":{\"id\":\"1047\"},\"ticker\":{\"id\":\"1013\"}},\"id\":\"1012\",\"type\":\"LinearAxis\"},{\"attributes\":{\"line_color\":\"orange\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1035\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1025\",\"type\":\"HelpTool\"},{\"attributes\":{},\"id\":\"1020\",\"type\":\"PanTool\"},{\"attributes\":{},\"id\":\"1047\",\"type\":\"AllLabels\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1056\",\"type\":\"Line\"},{\"attributes\":{\"overlay\":{\"id\":\"1026\"}},\"id\":\"1022\",\"type\":\"BoxZoomTool\"},{\"attributes\":{\"label\":{\"value\":\"\\u03b2(r)\\u2215\\u03b2\\u2080\"},\"renderers\":[{\"id\":\"1057\"}]},\"id\":\"1072\",\"type\":\"LegendItem\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1055\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1023\",\"type\":\"SaveTool\"},{\"attributes\":{},\"id\":\"1013\",\"type\":\"BasicTicker\"},{\"attributes\":{\"axis\":{\"id\":\"1012\"},\"coordinates\":null,\"group\":null,\"ticker\":null},\"id\":\"1015\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"1024\",\"type\":\"ResetTool\"},{\"attributes\":{},\"id\":\"1069\",\"type\":\"UnionRenderers\"},{\"attributes\":{},\"id\":\"1070\",\"type\":\"Selection\"},{\"attributes\":{\"tools\":[{\"id\":\"1020\"},{\"id\":\"1021\"},{\"id\":\"1022\"},{\"id\":\"1023\"},{\"id\":\"1024\"},{\"id\":\"1025\"}]},\"id\":\"1027\",\"type\":\"Toolbar\"},{\"attributes\":{},\"id\":\"1048\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1054\",\"type\":\"Line\"},{\"attributes\":{\"bottom_units\":\"screen\",\"coordinates\":null,\"fill_alpha\":0.5,\"fill_color\":\"lightgrey\",\"group\":null,\"left_units\":\"screen\",\"level\":\"overlay\",\"line_alpha\":1.0,\"line_color\":\"black\",\"line_dash\":[4,4],\"line_width\":2,\"right_units\":\"screen\",\"syncable\":false,\"top_units\":\"screen\"},\"id\":\"1026\",\"type\":\"BoxAnnotation\"},{\"attributes\":{},\"id\":\"1049\",\"type\":\"Selection\"},{\"attributes\":{\"label\":{\"value\":\"initial slope\"},\"renderers\":[{\"id\":\"1038\"}]},\"id\":\"1052\",\"type\":\"LegendItem\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1034\"},\"glyph\":{\"id\":\"1035\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1037\"},\"nonselection_glyph\":{\"id\":\"1036\"},\"view\":{\"id\":\"1039\"}},\"id\":\"1038\",\"type\":\"GlyphRenderer\"}],\"root_ids\":[\"1003\"]},\"title\":\"Bokeh Application\",\"version\":\"2.4.2\"}};\n",
       "  const render_items = [{\"docid\":\"edd4d6c9-cdc4-4439-b6be-02f845919ef3\",\"root_ids\":[\"1003\"],\"roots\":{\"1003\":\"340407f5-7af2-48b6-bfe4-897e389cb0f3\"}}];\n",
       "  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);\n",
       "\n",
       "  }\n",
       "  if (root.Bokeh !== undefined) {\n",
       "    embed_document(root);\n",
       "  } else {\n",
       "    let attempts = 0;\n",
       "    const timer = setInterval(function(root) {\n",
       "      if (root.Bokeh !== undefined) {\n",
       "        clearInterval(timer);\n",
       "        embed_document(root);\n",
       "      } else {\n",
       "        attempts++;\n",
       "        if (attempts > 100) {\n",
       "          clearInterval(timer);\n",
       "          console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\");\n",
       "        }\n",
       "      }\n",
       "    }, 10, root)\n",
       "  }\n",
       "})(window);"
      ],
      "application/vnd.bokehjs_exec.v0+json": ""
     },
     "metadata": {
      "application/vnd.bokehjs_exec.v0+json": {
       "id": "1003"
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Build theoretical curves for dimensionless r and beta\n",
    "r = np.linspace(0, 20, 200)\n",
    "beta = 1 / (1 + r)\n",
    "init_slope = 1 - r\n",
    "\n",
    "# Build plot\n",
    "p = bokeh.plotting.figure(\n",
    "    frame_height=225,\n",
    "    frame_width=350,\n",
    "    x_axis_label=\"r∕Kd\",\n",
    "    y_axis_label=\"β(r)∕β₀\",\n",
    "    x_range=[r[0], r[-1]],\n",
    "    y_range=[0, 1],\n",
    ")\n",
    "p.line(r, init_slope, line_width=2, color=\"orange\", legend_label=\"initial slope\")\n",
    "p.line(r, beta, line_width=2, legend_label=\"β(r)∕β₀\")\n",
    "p.legend.click_policy = \"hide\"\n",
    "p.legend[0].items = p.legend[0].items[::-1]\n",
    "\n",
    "bokeh.io.show(p)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Gene expression can be \"leaky\"\n",
    "\n",
    "In real life, many genes never get repressed all the way to zero expression, even when you add a lot of repressor. Instead, there is a baseline, or \"basal\", expression level that still occurs. A simple way to model this is by adding an additional constant term, $\\alpha_0$ to the expression \n",
    "\n",
    "\\begin{align}\n",
    "\\beta(R) = \\alpha_0 + \\beta_0 \\frac{p}{p_\\mathrm{tot}} = \\alpha_0 + \\frac{\\beta_0}{1+r/K_\\mathrm{d}}.\n",
    "\\end{align}\n",
    "\n",
    "Where does such leaky expression come from? Although there are many molecular sources of leakiness, the fundamental reason is that the molecular interactions inside a cell are always probabilistic. Even if there are many more repressors than there are genes to repress, at equilibrium these repressors are always transiently binding and unbinding from their targets so there is always a chance for gene expression to occur from a transiently un-repressed promoter.\n",
    "\n",
    "Given the ubiquity of leakiness, it is important to check that circuit behaviors do not depend on the absence of leaky expression.\n",
    "\n",
    "\n",
    "<!--\n",
    "<div class=\"alert alert-block alert-info\">\n",
    "Potential elaboration here: where does leak come from, molecularly? Is it the fact that you never get 100% occupancy? Or is it off-target binding of polymerases? etc.\n",
    "</div>\n",
    "\n",
    "<div class=\"alert alert-block alert-info\">\n",
    "JPM: I've added some commentary in the cell above.\n",
    "</div>\n",
    "-->"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "  <div class=\"bk-root\" id=\"30f2d5eb-7713-46dd-80d3-ea3fb52a67be\" data-root-id=\"1151\"></div>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/javascript": [
       "(function(root) {\n",
       "  function embed_document(root) {\n",
       "    \n",
       "  const docs_json = {\"7ce71bb0-d1f6-48ed-b90c-e4126a59b188\":{\"defs\":[],\"roots\":{\"references\":[{\"attributes\":{\"below\":[{\"id\":\"1160\"}],\"center\":[{\"id\":\"1163\"},{\"id\":\"1167\"},{\"id\":\"1199\"}],\"frame_height\":225,\"frame_width\":350,\"left\":[{\"id\":\"1164\"}],\"renderers\":[{\"id\":\"1186\"},{\"id\":\"1205\"}],\"title\":{\"id\":\"1188\"},\"toolbar\":{\"id\":\"1175\"},\"x_range\":{\"id\":\"1152\"},\"x_scale\":{\"id\":\"1156\"},\"y_range\":{\"id\":\"1154\"},\"y_scale\":{\"id\":\"1158\"}},\"id\":\"1151\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"axis\":{\"id\":\"1164\"},\"coordinates\":null,\"dimension\":1,\"group\":null,\"ticker\":null},\"id\":\"1167\",\"type\":\"Grid\"},{\"attributes\":{\"label\":{\"value\":\"\\u03b2(r)\\u2215\\u03b2\\u2080\"},\"renderers\":[{\"id\":\"1205\"}]},\"id\":\"1220\",\"type\":\"LegendItem\"},{\"attributes\":{\"axis_label\":\"\\u03b2(r)\\u2215\\u03b2\\u2080\",\"coordinates\":null,\"formatter\":{\"id\":\"1191\"},\"group\":null,\"major_label_policy\":{\"id\":\"1192\"},\"ticker\":{\"id\":\"1165\"}},\"id\":\"1164\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"1168\",\"type\":\"PanTool\"},{\"attributes\":{\"source\":{\"id\":\"1182\"}},\"id\":\"1187\",\"type\":\"CDSView\"},{\"attributes\":{\"click_policy\":\"hide\",\"coordinates\":null,\"group\":null,\"items\":[{\"id\":\"1220\"},{\"id\":\"1200\"}]},\"id\":\"1199\",\"type\":\"Legend\"},{\"attributes\":{\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1202\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1217\",\"type\":\"UnionRenderers\"},{\"attributes\":{},\"id\":\"1158\",\"type\":\"LinearScale\"},{\"attributes\":{\"axis\":{\"id\":\"1160\"},\"coordinates\":null,\"group\":null,\"ticker\":null},\"id\":\"1163\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"1218\",\"type\":\"Selection\"},{\"attributes\":{},\"id\":\"1156\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"1191\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"1161\",\"type\":\"BasicTicker\"},{\"attributes\":{\"axis_label\":\"r\\u2215Kd\",\"coordinates\":null,\"formatter\":{\"id\":\"1194\"},\"group\":null,\"major_label_policy\":{\"id\":\"1195\"},\"ticker\":{\"id\":\"1161\"}},\"id\":\"1160\",\"type\":\"LinearAxis\"},{\"attributes\":{\"data\":{\"x\":[0.0,20.0],\"y\":[0.25,0.25]},\"selected\":{\"id\":\"1197\"},\"selection_policy\":{\"id\":\"1196\"}},\"id\":\"1182\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"1192\",\"type\":\"AllLabels\"},{\"attributes\":{},\"id\":\"1165\",\"type\":\"BasicTicker\"},{\"attributes\":{},\"id\":\"1169\",\"type\":\"WheelZoomTool\"},{\"attributes\":{},\"id\":\"1194\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"1173\",\"type\":\"HelpTool\"},{\"attributes\":{},\"id\":\"1195\",\"type\":\"AllLabels\"},{\"attributes\":{\"overlay\":{\"id\":\"1174\"}},\"id\":\"1170\",\"type\":\"BoxZoomTool\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"orange\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1184\",\"type\":\"Line\"},{\"attributes\":{\"coordinates\":null,\"group\":null},\"id\":\"1188\",\"type\":\"Title\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1182\"},\"glyph\":{\"id\":\"1183\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1185\"},\"nonselection_glyph\":{\"id\":\"1184\"},\"view\":{\"id\":\"1187\"}},\"id\":\"1186\",\"type\":\"GlyphRenderer\"},{\"attributes\":{},\"id\":\"1196\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"line_color\":\"orange\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1183\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1172\",\"type\":\"ResetTool\"},{\"attributes\":{},\"id\":\"1197\",\"type\":\"Selection\"},{\"attributes\":{},\"id\":\"1171\",\"type\":\"SaveTool\"},{\"attributes\":{\"tools\":[{\"id\":\"1168\"},{\"id\":\"1169\"},{\"id\":\"1170\"},{\"id\":\"1171\"},{\"id\":\"1172\"},{\"id\":\"1173\"}]},\"id\":\"1175\",\"type\":\"Toolbar\"},{\"attributes\":{\"end\":1.25},\"id\":\"1154\",\"type\":\"Range1d\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"orange\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1185\",\"type\":\"Line\"},{\"attributes\":{\"source\":{\"id\":\"1201\"}},\"id\":\"1206\",\"type\":\"CDSView\"},{\"attributes\":{\"end\":20.0},\"id\":\"1152\",\"type\":\"Range1d\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1203\",\"type\":\"Line\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1218\"},\"selection_policy\":{\"id\":\"1217\"}},\"id\":\"1201\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"label\":{\"value\":\"basal expression, \\u03b1\\u2080\\u2215\\u03b2\\u2080\"},\"renderers\":[{\"id\":\"1186\"}]},\"id\":\"1200\",\"type\":\"LegendItem\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1201\"},\"glyph\":{\"id\":\"1202\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1204\"},\"nonselection_glyph\":{\"id\":\"1203\"},\"view\":{\"id\":\"1206\"}},\"id\":\"1205\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1204\",\"type\":\"Line\"},{\"attributes\":{\"bottom_units\":\"screen\",\"coordinates\":null,\"fill_alpha\":0.5,\"fill_color\":\"lightgrey\",\"group\":null,\"left_units\":\"screen\",\"level\":\"overlay\",\"line_alpha\":1.0,\"line_color\":\"black\",\"line_dash\":[4,4],\"line_width\":2,\"right_units\":\"screen\",\"syncable\":false,\"top_units\":\"screen\"},\"id\":\"1174\",\"type\":\"BoxAnnotation\"}],\"root_ids\":[\"1151\"]},\"title\":\"Bokeh Application\",\"version\":\"2.4.2\"}};\n",
       "  const render_items = [{\"docid\":\"7ce71bb0-d1f6-48ed-b90c-e4126a59b188\",\"root_ids\":[\"1151\"],\"roots\":{\"1151\":\"30f2d5eb-7713-46dd-80d3-ea3fb52a67be\"}}];\n",
       "  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);\n",
       "\n",
       "  }\n",
       "  if (root.Bokeh !== undefined) {\n",
       "    embed_document(root);\n",
       "  } else {\n",
       "    let attempts = 0;\n",
       "    const timer = setInterval(function(root) {\n",
       "      if (root.Bokeh !== undefined) {\n",
       "        clearInterval(timer);\n",
       "        embed_document(root);\n",
       "      } else {\n",
       "        attempts++;\n",
       "        if (attempts > 100) {\n",
       "          clearInterval(timer);\n",
       "          console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\");\n",
       "        }\n",
       "      }\n",
       "    }, 10, root)\n",
       "  }\n",
       "})(window);"
      ],
      "application/vnd.bokehjs_exec.v0+json": ""
     },
     "metadata": {
      "application/vnd.bokehjs_exec.v0+json": {
       "id": "1151"
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Build the theoretical curves\n",
    "r = np.linspace(0, 20, 200)\n",
    "alpha_0 = 0.25\n",
    "beta = alpha_0 + 1 / (1 + r)\n",
    "\n",
    "# Build plot\n",
    "p = bokeh.plotting.figure(\n",
    "    frame_height=225,\n",
    "    frame_width=350,\n",
    "    x_axis_label=\"r∕Kd\",\n",
    "    y_axis_label=\"β(r)∕β₀\",\n",
    "    x_range=[r[0], r[-1]],\n",
    "    y_range=[0, beta.max()],\n",
    ")\n",
    "p.line(\n",
    "    [r[0], r[-1]],\n",
    "    [alpha_0, alpha_0],\n",
    "    line_width=2,\n",
    "    color=\"orange\",\n",
    "    legend_label=\"basal expression, α₀∕β₀\",\n",
    ")\n",
    "p.line(r, beta, line_width=2, legend_label=\"β(r)∕β₀\")\n",
    "p.legend.click_policy = \"hide\"\n",
    "p.legend[0].items = p.legend[0].items[::-1]\n",
    "\n",
    "bokeh.io.show(p)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Activation\n",
    "\n",
    "Genes can be regulated by **activators** as well as repressors. Treating the case of activation just involves switching the state that is actively expressing from the unbound state to the state where the promoter region is bound by the protein (now called an activator). And, just as the binding of a repressor to DNA can be modulated by small molecule inputs, so too can the binding of the activator be modulated by binding to small molecules. In bacteria, one of many examples is the [Lux-type quorum sensing system](https://en.wikipedia.org/wiki/LuxR-type_DNA-binding_HTH_domain), where the transcription factor LuxR acts as an activator in the presence of its cognate ligand.\n",
    "\n",
    "<div style=\"width: 350px; margin: auto;\">\n",
    "\n",
    "![activation](figs/activation.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "<br />\n",
    "\n",
    "The rate of production of gene product as a function of activator concentration $a$ is\n",
    "\n",
    "\\begin{align}\n",
    "\\beta(a) = \\beta_0 \\frac{p_\\mathrm{occ}}{p_\\mathrm{tot}} = \\beta_0\\,\\frac{a/K_\\mathrm{d}}{1+a/K_\\mathrm{d}}.\n",
    "\\end{align}\n",
    "\n",
    "This produces the opposite, mirror image response compared to repression, shown below with no leakage."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "  <div class=\"bk-root\" id=\"018147f4-5402-436f-9096-b0140fb9b826\" data-root-id=\"1312\"></div>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/javascript": [
       "(function(root) {\n",
       "  function embed_document(root) {\n",
       "    \n",
       "  const docs_json = {\"0a296f45-73fc-49bc-af27-1025ded141e7\":{\"defs\":[],\"roots\":{\"references\":[{\"attributes\":{\"below\":[{\"id\":\"1321\"}],\"center\":[{\"id\":\"1324\"},{\"id\":\"1328\"},{\"id\":\"1360\"}],\"frame_height\":225,\"frame_width\":350,\"left\":[{\"id\":\"1325\"}],\"renderers\":[{\"id\":\"1347\"},{\"id\":\"1366\"}],\"title\":{\"id\":\"1349\"},\"toolbar\":{\"id\":\"1336\"},\"x_range\":{\"id\":\"1313\"},\"x_scale\":{\"id\":\"1317\"},\"y_range\":{\"id\":\"1315\"},\"y_scale\":{\"id\":\"1319\"}},\"id\":\"1312\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"end\":20.0},\"id\":\"1313\",\"type\":\"Range1d\"},{\"attributes\":{},\"id\":\"1332\",\"type\":\"SaveTool\"},{\"attributes\":{},\"id\":\"1352\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1344\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1333\",\"type\":\"ResetTool\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1345\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1329\",\"type\":\"PanTool\"},{\"attributes\":{\"line_color\":\"tomato\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1363\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1334\",\"type\":\"HelpTool\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"AAAAAAAAAACBhJ9ciLq5P4GEn1yIusk/YaN3ReZL0z+BhJ9ciLrZP9Gy4zmVFOA/YaN3ReZL4z/xkwtRN4PmP4GEn1yIuuk/EXUzaNnx7D/RsuM5lRTwPxmrrb89sPE/YaN3ReZL8z+pm0HLjuf0P/GTC1E3g/Y/OYzV1t8e+D+BhJ9ciLr5P8l8aeIwVvs/EXUzaNnx/D9Zbf3tgY3+P9Gy4zmVFABA9a7IfGniAEAZq62/PbABQD2nkgISfgJAYaN3ReZLA0CFn1yIuhkEQKmbQcuO5wRAzZcmDmO1BUDxkwtRN4MGQBWQ8JMLUQdAOYzV1t8eCEBdiLoZtOwIQIGEn1yIuglApYCEn1yICkDJfGniMFYLQO14TiUFJAxAEXUzaNnxDEA1cRirrb8NQFlt/e2BjQ5AfWniMFZbD0DRsuM5lRQQQOMwVlt/exBA9a7IfGniEEAHLTueU0kRQBmrrb89sBFAKykg4ScXEkA9p5ICEn4SQE8lBST85BJAYaN3ReZLE0BzIepm0LITQIWfXIi6GRRAlx3PqaSAFECpm0HLjucUQLsZtOx4ThVAzZcmDmO1FUDfFZkvTRwWQPGTC1E3gxZAAxJ+ciHqFkAVkPCTC1EXQCcOY7X1txdAOYzV1t8eGEBLCkj4yYUYQF2Iuhm07BhAbwYtO55TGUCBhJ9ciLoZQJMCEn5yIRpApYCEn1yIGkC3/vbARu8aQMl8aeIwVhtA2/rbAxu9G0DteE4lBSQcQP/2wEbvihxAEXUzaNnxHEAj86WJw1gdQDVxGKutvx1AR++KzJcmHkBZbf3tgY0eQGvrbw9s9B5AfWniMFZbH0CP51RSQMIfQNGy4zmVFCBA2vGcSgpIIEDjMFZbf3sgQOxvD2z0riBA9a7IfGniIED+7YGN3hUhQActO55TSSFAEGz0rsh8IUAZq62/PbAhQCLqZtCy4yFAKykg4ScXIkA0aNnxnEoiQD2nkgISfiJARuZLE4exIkBPJQUk/OQiQFhkvjRxGCNAYaN3ReZLI0Bq4jBWW38jQHMh6mbQsiNAfGCjd0XmI0CFn1yIuhkkQI7eFZkvTSRAlx3PqaSAJECgXIi6GbQkQKmbQcuO5yRAstr62wMbJUC7GbTseE4lQMRYbf3tgSVAzZcmDmO1JUDW1t8e2OglQN8VmS9NHCZA6FRSQMJPJkDxkwtRN4MmQPrSxGGstiZAAxJ+ciHqJkAMUTeDlh0nQBWQ8JMLUSdAHs+ppICEJ0AnDmO19bcnQDBNHMZq6ydAOYzV1t8eKEBCy47nVFIoQEsKSPjJhShAVEkBCT+5KEBdiLoZtOwoQGbHcyopIClAbwYtO55TKUB4ReZLE4cpQIGEn1yIuilAisNYbf3tKUCTAhJ+ciEqQJxBy47nVCpApYCEn1yIKkCuvz2w0bsqQLf+9sBG7ypAwD2w0bsiK0DJfGniMFYrQNK7IvOliStA2/rbAxu9K0DkOZUUkPArQO14TiUFJCxA9rcHNnpXLED/9sBG74osQAg2eldkvixAEXUzaNnxLEAatOx4TiUtQCPzpYnDWC1ALDJfmjiMLUA1cRirrb8tQD6w0bsi8y1AR++KzJcmLkBQLkTdDFouQFlt/e2BjS5AYqy2/vbALkBr628PbPQuQHQqKSDhJy9AfWniMFZbL0CGqJtBy44vQI/nVFJAwi9AmCYOY7X1L0DRsuM5lRQwQFVSQMJPLjBA2vGcSgpIMEBekfnSxGEwQOMwVlt/ezBAZ9Cy4zmVMEDsbw9s9K4wQHAPbPSuyDBA9a7IfGniMEB5TiUFJPwwQP7tgY3eFTFAgo3eFZkvMUAHLTueU0kxQIvMlyYOYzFAEGz0rsh8MUCUC1E3g5YxQBmrrb89sDFAnUoKSPjJMUAi6mbQsuMxQKaJw1ht/TFAKykg4ScXMkCvyHxp4jAyQDRo2fGcSjJAuAc2eldkMkA9p5ICEn4yQMFG74rMlzJARuZLE4exMkDKhaibQcsyQE8lBST85DJA08RhrLb+MkBYZL40cRgzQNwDG70rMjNAYaN3ReZLM0DlQtTNoGUzQGriMFZbfzNA7oGN3hWZM0BzIepm0LIzQPfARu+KzDNAfGCjd0XmM0AAAAAAAAA0QA==\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1358\"},\"selection_policy\":{\"id\":\"1357\"}},\"id\":\"1343\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"1322\",\"type\":\"BasicTicker\"},{\"attributes\":{\"overlay\":{\"id\":\"1335\"}},\"id\":\"1331\",\"type\":\"BoxZoomTool\"},{\"attributes\":{},\"id\":\"1355\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1379\"},\"selection_policy\":{\"id\":\"1378\"}},\"id\":\"1362\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"1357\",\"type\":\"UnionRenderers\"},{\"attributes\":{},\"id\":\"1317\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"1319\",\"type\":\"LinearScale\"},{\"attributes\":{\"axis\":{\"id\":\"1325\"},\"coordinates\":null,\"dimension\":1,\"group\":null,\"ticker\":null},\"id\":\"1328\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"1326\",\"type\":\"BasicTicker\"},{\"attributes\":{\"tools\":[{\"id\":\"1329\"},{\"id\":\"1330\"},{\"id\":\"1331\"},{\"id\":\"1332\"},{\"id\":\"1333\"},{\"id\":\"1334\"}]},\"id\":\"1336\",\"type\":\"Toolbar\"},{\"attributes\":{\"label\":{\"value\":\"\\u03b2(a)\\u2215\\u03b2\\u2080\"},\"renderers\":[{\"id\":\"1347\"}]},\"id\":\"1361\",\"type\":\"LegendItem\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#1f77b4\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1346\",\"type\":\"Line\"},{\"attributes\":{\"axis_label\":\"\\u03b2\\u2215\\u03b2\\u2080\",\"coordinates\":null,\"formatter\":{\"id\":\"1352\"},\"group\":null,\"major_label_policy\":{\"id\":\"1353\"},\"ticker\":{\"id\":\"1326\"}},\"id\":\"1325\",\"type\":\"LinearAxis\"},{\"attributes\":{},\"id\":\"1378\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1343\"},\"glyph\":{\"id\":\"1344\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1346\"},\"nonselection_glyph\":{\"id\":\"1345\"},\"view\":{\"id\":\"1348\"}},\"id\":\"1347\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1362\"},\"glyph\":{\"id\":\"1363\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1365\"},\"nonselection_glyph\":{\"id\":\"1364\"},\"view\":{\"id\":\"1367\"}},\"id\":\"1366\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"source\":{\"id\":\"1343\"}},\"id\":\"1348\",\"type\":\"CDSView\"},{\"attributes\":{\"source\":{\"id\":\"1362\"}},\"id\":\"1367\",\"type\":\"CDSView\"},{\"attributes\":{\"label\":{\"value\":\"\\u03b2(r)\\u2215\\u03b2\\u2080\"},\"renderers\":[{\"id\":\"1366\"}]},\"id\":\"1381\",\"type\":\"LegendItem\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"tomato\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1365\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1358\",\"type\":\"Selection\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"tomato\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1364\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1356\",\"type\":\"AllLabels\"},{\"attributes\":{},\"id\":\"1379\",\"type\":\"Selection\"},{\"attributes\":{},\"id\":\"1330\",\"type\":\"WheelZoomTool\"},{\"attributes\":{\"coordinates\":null,\"group\":null,\"items\":[{\"id\":\"1361\"},{\"id\":\"1381\"}],\"location\":\"center_right\"},\"id\":\"1360\",\"type\":\"Legend\"},{\"attributes\":{\"axis\":{\"id\":\"1321\"},\"coordinates\":null,\"group\":null,\"ticker\":null},\"id\":\"1324\",\"type\":\"Grid\"},{\"attributes\":{\"axis_label\":\"a\\u2215Kd, r\\u2215Kd\",\"coordinates\":null,\"formatter\":{\"id\":\"1355\"},\"group\":null,\"major_label_policy\":{\"id\":\"1356\"},\"ticker\":{\"id\":\"1322\"}},\"id\":\"1321\",\"type\":\"LinearAxis\"},{\"attributes\":{\"bottom_units\":\"screen\",\"coordinates\":null,\"fill_alpha\":0.5,\"fill_color\":\"lightgrey\",\"group\":null,\"left_units\":\"screen\",\"level\":\"overlay\",\"line_alpha\":1.0,\"line_color\":\"black\",\"line_dash\":[4,4],\"line_width\":2,\"right_units\":\"screen\",\"syncable\":false,\"top_units\":\"screen\"},\"id\":\"1335\",\"type\":\"BoxAnnotation\"},{\"attributes\":{\"coordinates\":null,\"group\":null},\"id\":\"1349\",\"type\":\"Title\"},{\"attributes\":{},\"id\":\"1353\",\"type\":\"AllLabels\"},{\"attributes\":{},\"id\":\"1315\",\"type\":\"Range1d\"}],\"root_ids\":[\"1312\"]},\"title\":\"Bokeh Application\",\"version\":\"2.4.2\"}};\n",
       "  const render_items = [{\"docid\":\"0a296f45-73fc-49bc-af27-1025ded141e7\",\"root_ids\":[\"1312\"],\"roots\":{\"1312\":\"018147f4-5402-436f-9096-b0140fb9b826\"}}];\n",
       "  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);\n",
       "\n",
       "  }\n",
       "  if (root.Bokeh !== undefined) {\n",
       "    embed_document(root);\n",
       "  } else {\n",
       "    let attempts = 0;\n",
       "    const timer = setInterval(function(root) {\n",
       "      if (root.Bokeh !== undefined) {\n",
       "        clearInterval(timer);\n",
       "        embed_document(root);\n",
       "      } else {\n",
       "        attempts++;\n",
       "        if (attempts > 100) {\n",
       "          clearInterval(timer);\n",
       "          console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\");\n",
       "        }\n",
       "      }\n",
       "    }, 10, root)\n",
       "  }\n",
       "})(window);"
      ],
      "application/vnd.bokehjs_exec.v0+json": ""
     },
     "metadata": {
      "application/vnd.bokehjs_exec.v0+json": {
       "id": "1312"
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "a = np.linspace(0, 20, 200)\n",
    "beta_A = a / (1 + a)\n",
    "beta_R = 1 / (1 + r)\n",
    "\n",
    "# Build plot\n",
    "p = bokeh.plotting.figure(\n",
    "    frame_height=225,\n",
    "    frame_width=350,\n",
    "    x_axis_label=\"a∕Kd, r∕Kd\",\n",
    "    y_axis_label=\"β∕β₀\",\n",
    "    x_range=[r[0], r[-1]],\n",
    "    y_range=[0, 1],\n",
    ")\n",
    "\n",
    "p.line(a, beta_A, line_width=2, legend_label=\"β(a)∕β₀\")\n",
    "p.line(r, beta_R, line_width=2, color=\"tomato\", legend_label=\"β(r)∕β₀\")\n",
    "p.legend.location = \"center_right\"\n",
    "bokeh.io.show(p)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Hill functions and ultrasensitivity\n",
    "\n",
    "While the activating and repressing functions we derive above indeed capture the behavior of this simple model of transcriptional regulation, in practice we find that many responses in gene regulation and protein-protein interactions have a switch-like shape, or **ultrasensitive** behavior. Ultrasensitivity can arise from many sources, but a major factor is often the **cooperativity** in molecular interactions. For example, consider a situation in which binding of a protein at one DNA binding site increases the affinity for binding of a second protein at an adjacent site. Or, imagine a protein with an alternative molecular conformation that is stabilized by binding of multiple agonist effector molecules and, in that conformation, has a higher affinity for the same effectors. In these and many other situations, an increasing concentration of one species can have little effect for a while, and then suddenly have a large effect. \n",
    "\n",
    "The Hill function provides a way to analyze systems that exhibit ultrasensitive responses. While it can be derived from models of some processes, it is often used in a more generic way to analyze how a circuit would behave with different levels of ultrasensitivity.\n",
    "\n",
    "An activating Hill function is defined by \n",
    "\n",
    "\\begin{align}\n",
    "f_\\mathrm{act}(x) &= \\frac{x^n}{k^n +x^n} = \\frac{(x/k)^n}{1 + (x/k)^n}.\n",
    "\\end{align}\n",
    "\n",
    "You can also make a mirror image repressive Hill function. \n",
    "\n",
    "\\begin{align}\n",
    "f_\\mathrm{rep}(x) &= \\frac{k^n}{k^n +x^n} = \\frac{1}{1 + (x/k)^n}.\n",
    "\\end{align}\n",
    "\n",
    "In these expressions, $k$ is often referred to as an **activation coefficient**; it represents the concentration at which the function attains half its maximal value. It is a measure of the concentration $x$ that is necessary to affect the regulation. The **Hill coefficient**, $n$, parametrizes how ultrasensitive the response is. When $n=1$, we recover the simple binding curves introduced earlier. When $n>1$, however, we achieve ever sharper, more ultrasensitive, responses. In the limit of $n=\\infty$ we have a step function. \n",
    "\n",
    "The production rate of the products of genes under control of an activator and repressor, respectively, operating with ultrasensitivity modeled with Hill function is\n",
    "\n",
    "\\begin{align}\n",
    "&\\beta(a) = \\beta_0\\,f_\\mathrm{act}(a) = \\beta_0 \\,\\frac{(a/k)^n}{1 + (a/k)^n},\\\\[1em]\n",
    "&\\beta(r) = \\beta_0\\,f_\\mathrm{rep}(r) = \\beta_0 \\,\\frac{1}{1 + (r/k)^n}.\n",
    "\\end{align}\n",
    "\n",
    "Here we plot Hill functiona for a few values of $n$, with activating Hill functions in blue and repressing Hill functions in red."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "  <div class=\"bk-root\" id=\"264f38d6-fadf-43d8-b73f-6d4d13621d7d\" data-root-id=\"1551\"></div>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/javascript": [
       "(function(root) {\n",
       "  function embed_document(root) {\n",
       "    \n",
       "  const docs_json = {\"06141408-a0d0-407f-a09b-320925ebff54\":{\"defs\":[],\"roots\":{\"references\":[{\"attributes\":{\"children\":[{\"id\":\"1486\"},{\"id\":\"1517\"},{\"id\":\"1550\"}]},\"id\":\"1551\",\"type\":\"Column\"},{\"attributes\":{\"coordinates\":null,\"group\":null},\"id\":\"1559\",\"type\":\"Title\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1572\"},\"glyph\":{\"id\":\"1573\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1575\"},\"nonselection_glyph\":{\"id\":\"1574\"},\"view\":{\"id\":\"1577\"}},\"id\":\"1576\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"line_color\":\"#6baed6\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1573\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1610\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1589\"},\"selection_policy\":{\"id\":\"1588\"}},\"id\":\"1572\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"source\":{\"id\":\"1572\"}},\"id\":\"1577\",\"type\":\"CDSView\"},{\"attributes\":{\"label\":{\"value\":\"n = 2\"},\"renderers\":[{\"id\":\"1576\"}]},\"id\":\"1591\",\"type\":\"LegendItem\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#6baed6\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1575\",\"type\":\"Line\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#6baed6\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1574\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1493\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"1491\",\"type\":\"LogScale\"},{\"attributes\":{\"num_minor_ticks\":10},\"id\":\"1496\",\"type\":\"LogTicker\"},{\"attributes\":{\"axis\":{\"id\":\"1495\"},\"coordinates\":null,\"group\":null,\"ticker\":null},\"id\":\"1498\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"1588\",\"type\":\"UnionRenderers\"},{\"attributes\":{},\"id\":\"1589\",\"type\":\"Selection\"},{\"attributes\":{\"bottom_units\":\"screen\",\"coordinates\":null,\"fill_alpha\":0.5,\"fill_color\":\"lightgrey\",\"group\":null,\"left_units\":\"screen\",\"level\":\"overlay\",\"line_alpha\":1.0,\"line_color\":\"black\",\"line_dash\":[4,4],\"line_width\":2,\"right_units\":\"screen\",\"syncable\":false,\"top_units\":\"screen\"},\"id\":\"1509\",\"type\":\"BoxAnnotation\"},{\"attributes\":{\"tools\":[{\"id\":\"1503\"},{\"id\":\"1504\"},{\"id\":\"1505\"},{\"id\":\"1506\"},{\"id\":\"1507\"},{\"id\":\"1508\"}]},\"id\":\"1510\",\"type\":\"Toolbar\"},{\"attributes\":{\"tools\":[{\"id\":\"1534\"},{\"id\":\"1535\"},{\"id\":\"1536\"},{\"id\":\"1537\"},{\"id\":\"1538\"},{\"id\":\"1539\"}]},\"id\":\"1541\",\"type\":\"Toolbar\"},{\"attributes\":{},\"id\":\"1531\",\"type\":\"BasicTicker\"},{\"attributes\":{\"axis\":{\"id\":\"1530\"},\"coordinates\":null,\"dimension\":1,\"group\":null,\"ticker\":null},\"id\":\"1533\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"1649\",\"type\":\"UnionRenderers\"},{\"attributes\":{},\"id\":\"1535\",\"type\":\"WheelZoomTool\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1633\"},\"glyph\":{\"id\":\"1634\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1636\"},\"nonselection_glyph\":{\"id\":\"1635\"},\"view\":{\"id\":\"1638\"}},\"id\":\"1637\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"axis\":{\"id\":\"1526\"},\"coordinates\":null,\"group\":null,\"ticker\":null},\"id\":\"1529\",\"type\":\"Grid\"},{\"attributes\":{\"bottom_units\":\"screen\",\"coordinates\":null,\"fill_alpha\":0.5,\"fill_color\":\"lightgrey\",\"group\":null,\"left_units\":\"screen\",\"level\":\"overlay\",\"line_alpha\":1.0,\"line_color\":\"black\",\"line_dash\":[4,4],\"line_width\":2,\"right_units\":\"screen\",\"syncable\":false,\"top_units\":\"screen\"},\"id\":\"1540\",\"type\":\"BoxAnnotation\"},{\"attributes\":{\"line_color\":\"#fb6a4a\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1634\",\"type\":\"Line\"},{\"attributes\":{\"num_minor_ticks\":10},\"id\":\"1527\",\"type\":\"LogTicker\"},{\"attributes\":{\"children\":[{\"id\":\"1549\"},{\"id\":\"1548\"}]},\"id\":\"1550\",\"type\":\"Row\"},{\"attributes\":{},\"id\":\"1522\",\"type\":\"LogScale\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1650\"},\"selection_policy\":{\"id\":\"1649\"}},\"id\":\"1633\",\"type\":\"ColumnDataSource\"},{\"attributes\":{},\"id\":\"1524\",\"type\":\"LinearScale\"},{\"attributes\":{\"source\":{\"id\":\"1633\"}},\"id\":\"1638\",\"type\":\"CDSView\"},{\"attributes\":{\"label\":{\"value\":\"n = 2\"},\"renderers\":[{\"id\":\"1637\"}]},\"id\":\"1652\",\"type\":\"LegendItem\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#fb6a4a\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1636\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1539\",\"type\":\"HelpTool\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#fb6a4a\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1635\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1538\",\"type\":\"ResetTool\"},{\"attributes\":{\"line_color\":\"#de2d26\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1654\",\"type\":\"Line\"},{\"attributes\":{\"axis_label\":\"x/k\",\"coordinates\":null,\"formatter\":{\"id\":\"1626\"},\"group\":null,\"major_label_policy\":{\"id\":\"1627\"},\"ticker\":{\"id\":\"1527\"}},\"id\":\"1526\",\"type\":\"LogAxis\"},{\"attributes\":{\"width\":145},\"id\":\"1549\",\"type\":\"Spacer\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1592\"},\"glyph\":{\"id\":\"1593\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1595\"},\"nonselection_glyph\":{\"id\":\"1594\"},\"view\":{\"id\":\"1597\"}},\"id\":\"1596\",\"type\":\"GlyphRenderer\"},{\"attributes\":{},\"id\":\"1650\",\"type\":\"Selection\"},{\"attributes\":{},\"id\":\"1537\",\"type\":\"SaveTool\"},{\"attributes\":{\"line_color\":\"#3182bd\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1593\",\"type\":\"Line\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"JUKSDKGcxzsr2Ji8JMHSOwgLxNztyt07kYkk1e+p5ztHQnivtsvyOz5uKnC42/07UGTLHUa3BzxgyG2XTtYSPCLEQ3qM7B08Cf3A6qPEJzxD9tR37OAyPMh+ZQBq/T08neBBQAnSRzw2PAtUkOtSPJIR6AdRDl481v6MInbfZzwa8G8vOvZyPLrzJpZBH348S6zjlershzwtTmQN6gCTPOGggLA7MJ48ZaOJnmb6pzzaekvxnwuzPH+bVlw/Qb48yAXFQOoHyDx6goreWxbTPHhuDZ9MUt48Tl7egHUV6DzmW4jYHSHzPG+uDH5jY/48yaAgYwgjCD1S6K3i5SsTPUD8vv6DdB493yzZ66IwKD139GUAtDYzPfQDkiauhT49KM1XH0U+SD2nOB01iEFTPVp99vrhll49cbTuAe9LaD03U0KEYkxzPcodYIEfqH49i23yl6BZiD2etEXxQleTPW1iRb9muZ49GJW55VlnqD27RZl/KWKzPQKvHrq3yr49sL2b7xp1yD1lAK8yFm3TPezAYncS3N49Y/PsueOC6D3pRvMNCXjzPUhnePx27f49o7XrSLSQCD6SJLYUAoMTPlYZfU7l/h4+vIZ4oIyeKD5M5s9JAY4zPhhNXnFdED8+hd/ywmysSD4B3jGuBplTPoy4OmTfIV8+pdenrFS6aD7A8CI7EqRzPrf61hJrM38+eSZ4QUTIiD4izBfLI6+TPqWXLhsARZ8+KVEdAzvWqD5IQqu8OrqzPiBlsOKcVr8+Bhny6DbkyD6b0tx8VMXTPk2kEOc6aN8+3F/juS/y6D7jSISpZtDzPvhvMvG/ef8+GAS9XwQACT+fFbGBR9sTP63QKqLCih8/zc1v6C8NKT+vCpJNT+UzP0UoJt6bmT8/TklDv5wXST9tq7pg3etTP63OvHqsn18/lSkhtPQWaT9FpfJRduRzP0hGsnGmgn8/scTU3VHqiD8qotOyK6aTP5ne+ySE3Z4/li5JNKMWqD8q4uCxE56yP1eAVhJ0XLw/yIVMDNglxT+ahEOqD57OP38IJ6NUUdU/vPxEUlRQ3D+Xgd3W1dfhP8J7bK5VV+U/1x5vFXxY6D+N3uz8ibbqP/kvtX1xdOw/t+PDiT2s7T8WbbvMlX7uPwsh2N4TCe8/72Jpos5i7z/urIi4VpzvP3SbHLP6wO8/tRpcEzfY7z/W3ksL6ebvP5mhwikw8O8/qqJPEQr27z8uL9AYuvnvPzs7hMwM/O8/v00WVoP97z8DeQEtb/7vP6nu6qkD/+8/d/LDJWH/7z8Mge7/m//vP5sdgAzB/+8/96wyX9j/7z8dRtAN5//vP3iM4kvw/+8/ksFVHfb/7z/DRfLG+f/vP6pjLBX8/+8/a6i4iP3/7z/OT5xy/v/vPyf/1wX//+8/p+GGYv//7z/67t6c///vP9opmcH//+8/itu32P//7z9Tq0Xn///vP04Qb/D//+8/qXwz9v//7z/P5NT5///vP1L0Hfz//+8/1z+O/f//7z82F3b+///vP9YICP///+8/7+dj////7z8vvZ3////vPxIlwv///+8/7g/Z////7z8cfef////vP/eR8P///+8/dUn2////7z+54vn////vP6km/P///+8/u5P9////7z+Kef7////vPzUK/////+8/RmX/////7z+Znv/////vP7DC/////+8/Z9n/////7z+05//////vP7Xw/////+8/X/b/////7z/w+f/////vPy/8/////+8/mf3/////7z99/v/////vPwz//////+8/Z///////7z+f///////vP8P//////+8/2v//////7z/o///////vP/H//////+8/9v//////7z/6///////vP/z//////+8//v//////7z/////////vP/7//////+8/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1611\"},\"selection_policy\":{\"id\":\"1610\"}},\"id\":\"1592\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"source\":{\"id\":\"1592\"}},\"id\":\"1597\",\"type\":\"CDSView\"},{\"attributes\":{\"axis_label\":\"repressing Hill function\",\"coordinates\":null,\"formatter\":{\"id\":\"1623\"},\"group\":null,\"major_label_policy\":{\"id\":\"1624\"},\"ticker\":{\"id\":\"1531\"}},\"id\":\"1530\",\"type\":\"LinearAxis\"},{\"attributes\":{\"label\":{\"value\":\"n = 10\"},\"renderers\":[{\"id\":\"1596\"}]},\"id\":\"1613\",\"type\":\"LegendItem\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#3182bd\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1595\",\"type\":\"Line\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#3182bd\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1594\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1534\",\"type\":\"PanTool\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1629\"},\"selection_policy\":{\"id\":\"1628\"}},\"id\":\"1614\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"overlay\":{\"id\":\"1540\"}},\"id\":\"1536\",\"type\":\"BoxZoomTool\"},{\"attributes\":{},\"id\":\"1489\",\"type\":\"DataRange1d\"},{\"attributes\":{\"end\":100.0,\"start\":0.01},\"id\":\"1487\",\"type\":\"Range1d\"},{\"attributes\":{},\"id\":\"1611\",\"type\":\"Selection\"},{\"attributes\":{\"axis_label\":\"x/k\",\"coordinates\":null,\"formatter\":{\"id\":\"1565\"},\"group\":null,\"major_label_policy\":{\"id\":\"1566\"},\"ticker\":{\"id\":\"1496\"}},\"id\":\"1495\",\"type\":\"LogAxis\"},{\"attributes\":{\"end\":100.0,\"start\":0.01},\"id\":\"1518\",\"type\":\"Range1d\"},{\"attributes\":{\"active\":0,\"js_property_callbacks\":{\"change:active\":[{\"id\":\"1552\"}]},\"labels\":[\"activating\",\"repressing\"],\"width\":100},\"id\":\"1548\",\"type\":\"RadioButtonGroup\"},{\"attributes\":{},\"id\":\"1507\",\"type\":\"ResetTool\"},{\"attributes\":{\"below\":[{\"id\":\"1495\"}],\"center\":[{\"id\":\"1498\"},{\"id\":\"1502\"},{\"id\":\"1570\"}],\"frame_height\":225,\"frame_width\":350,\"left\":[{\"id\":\"1499\"}],\"renderers\":[{\"id\":\"1557\"},{\"id\":\"1576\"},{\"id\":\"1596\"}],\"title\":{\"id\":\"1559\"},\"toolbar\":{\"id\":\"1510\"},\"x_range\":{\"id\":\"1487\"},\"x_scale\":{\"id\":\"1491\"},\"y_range\":{\"id\":\"1489\"},\"y_scale\":{\"id\":\"1493\"}},\"id\":\"1486\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{},\"id\":\"1508\",\"type\":\"HelpTool\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1653\"},\"glyph\":{\"id\":\"1654\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1656\"},\"nonselection_glyph\":{\"id\":\"1655\"},\"view\":{\"id\":\"1658\"}},\"id\":\"1657\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"ticker\":null},\"id\":\"1565\",\"type\":\"LogTickFormatter\"},{\"attributes\":{},\"id\":\"1672\",\"type\":\"Selection\"},{\"attributes\":{},\"id\":\"1566\",\"type\":\"AllLabels\"},{\"attributes\":{\"below\":[{\"id\":\"1526\"}],\"center\":[{\"id\":\"1529\"},{\"id\":\"1533\"},{\"id\":\"1631\"}],\"frame_height\":225,\"frame_width\":350,\"left\":[{\"id\":\"1530\"}],\"renderers\":[{\"id\":\"1618\"},{\"id\":\"1637\"},{\"id\":\"1657\"}],\"title\":{\"id\":\"1620\"},\"toolbar\":{\"id\":\"1541\"},\"visible\":false,\"x_range\":{\"id\":\"1518\"},\"x_scale\":{\"id\":\"1522\"},\"y_range\":{\"id\":\"1520\"},\"y_scale\":{\"id\":\"1524\"}},\"id\":\"1517\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D/////////vP////////+8/////////7z/+///////vP/z//////+8/+v//////7z/2///////vP/H//////+8/6P//////7z/a///////vP8P//////+8/n///////7z9n///////vPwz//////+8/ff7/////7z+Z/f/////vPy/8/////+8/8Pn/////7z9f9v/////vP7Xw/////+8/tOf/////7z9n2f/////vP7DC/////+8/mZ7/////7z9GZf/////vPzUK/////+8/inn+////7z+7k/3////vP6km/P///+8/ueL5////7z91Sfb////vP/eR8P///+8/HH3n////7z/uD9n////vPxIlwv///+8/L72d////7z/v52P////vP9YICP///+8/Nhd2/v//7z/XP479///vP1L0Hfz//+8/z+TU+f//7z+pfDP2///vP04Qb/D//+8/U6tF5///7z+K27fY///vP9opmcH//+8/+u7enP//7z+n4YZi///vPyf/1wX//+8/zk+ccv7/7z9rqLiI/f/vP6pjLBX8/+8/w0Xyxvn/7z+SwVUd9v/vP3iM4kvw/+8/HUbQDef/7z/3rDJf2P/vP5sdgAzB/+8/DIHu/5v/7z938sMlYf/vP6nu6qkD/+8/A3kBLW/+7z+/TRZWg/3vPzs7hMwM/O8/Li/QGLr57z+qok8RCvbvP5mhwikw8O8/1t5LC+nm7z+1GlwTN9jvP3ObHLP6wO8/7ayIuFac7z/vYmmizmLvPwsh2N4TCe8/F227zJV+7j+748OJPaztP/UvtX1xdOw/jt7s/Im26j/aHm8VfFjoP8B7bK5VV+U/ooHd1tXX4T/S/ERSVFDcP3wIJ6NUUdU/pIRDqg+ezj/MhUwM2CXFPziAVhJ0XLw/SOLgsROesj+gLkk0oxaoP6De+ySE3Z4/IKLTsiumkz+AxNTdUeqIPwBGsnGmgn8/gKXyUXbkcz8AKiG09BZpPwDOvHqsn18/AKy6YN3rUz8ASEO/nBdJPwAoJt6bmT8/AAiSTU/lMz8A0G/oLw0pPwDgKqLCih8/ACCxgUfbEz8AAL1fBAAJPwCAMvG/ef8+AICEqWbQ8z4AAOO5L/LoPgAAEOc6aN8+AADcfFTF0z4AAPToNuTIPgAAsOKcVr8+AACovDq6sz4AACADO9aoPgAAIBsARZ8+AAAgyyOvkz4AAIBBRMiIPgAAABNrM38+AAAAOxKkcz4AAACtVLpoPgAAAGTfIV8+AAAArgaZUz4AAADEbKxIPgAAAHBdED8+AAAASAGOMz4AAACgjJ4oPgAAAEDl/h4+AAAAIAKDEz4AAABAtJAIPgAAAAB37f49AAAAAAl48z0AAAAA5ILoPQAAAAAS3N49AAAAABZt0z0AAAAAHHXIPQAAAAC4yr49AAAAAChisz0AAAAAYGeoPQAAAABguZ49AAAAAEBXkz0AAAAAwFmIPQAAAAAAqH49AAAAAIBMcz0AAAAAAExoPQAAAAAAll49AAAAAABCUz0AAAAAAEBIPQAAAAAAiD49AAAAAAA4Mz0AAAAAADAoPQAAAAAAgB49AAAAAAAgEz0AAAAAAEAIPQAAAAAAgP48AAAAAAAA8zwAAAAAAADoPAAAAAAAAN48AAAAAAAA1DwAAAAAAADIPAAAAAAAAMA8AAAAAAAAsDwAAAAAAACgPAAAAAAAALA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1672\"},\"selection_policy\":{\"id\":\"1671\"}},\"id\":\"1653\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"line_color\":\"#fcae91\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1615\",\"type\":\"Line\"},{\"attributes\":{\"source\":{\"id\":\"1653\"}},\"id\":\"1658\",\"type\":\"CDSView\"},{\"attributes\":{\"label\":{\"value\":\"n = 10\"},\"renderers\":[{\"id\":\"1657\"}]},\"id\":\"1674\",\"type\":\"LegendItem\"},{\"attributes\":{},\"id\":\"1562\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#de2d26\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1656\",\"type\":\"Line\"},{\"attributes\":{\"data\":{\"x\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]},\"y\":{\"__ndarray__\":\"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\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[200]}},\"selected\":{\"id\":\"1568\"},\"selection_policy\":{\"id\":\"1567\"}},\"id\":\"1553\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#de2d26\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1655\",\"type\":\"Line\"},{\"attributes\":{},\"id\":\"1563\",\"type\":\"AllLabels\"},{\"attributes\":{},\"id\":\"1671\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1614\"},\"glyph\":{\"id\":\"1615\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1617\"},\"nonselection_glyph\":{\"id\":\"1616\"},\"view\":{\"id\":\"1619\"}},\"id\":\"1618\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"line_color\":\"#bdd7e7\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1554\",\"type\":\"Line\"},{\"attributes\":{\"label\":{\"value\":\"n = 1\"},\"renderers\":[{\"id\":\"1618\"}]},\"id\":\"1632\",\"type\":\"LegendItem\"},{\"attributes\":{},\"id\":\"1567\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"source\":{\"id\":\"1614\"}},\"id\":\"1619\",\"type\":\"CDSView\"},{\"attributes\":{},\"id\":\"1568\",\"type\":\"Selection\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#fcae91\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1617\",\"type\":\"Line\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#fcae91\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1616\",\"type\":\"Line\"},{\"attributes\":{\"coordinates\":null,\"group\":null,\"items\":[{\"id\":\"1632\"},{\"id\":\"1652\"},{\"id\":\"1674\"}],\"location\":\"center_right\"},\"id\":\"1631\",\"type\":\"Legend\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1553\"},\"glyph\":{\"id\":\"1554\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1556\"},\"nonselection_glyph\":{\"id\":\"1555\"},\"view\":{\"id\":\"1558\"}},\"id\":\"1557\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"axis_label\":\"activating Hill function\",\"coordinates\":null,\"formatter\":{\"id\":\"1562\"},\"group\":null,\"major_label_policy\":{\"id\":\"1563\"},\"ticker\":{\"id\":\"1500\"}},\"id\":\"1499\",\"type\":\"LinearAxis\"},{\"attributes\":{\"coordinates\":null,\"group\":null},\"id\":\"1620\",\"type\":\"Title\"},{\"attributes\":{\"line_alpha\":0.2,\"line_color\":\"#bdd7e7\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1556\",\"type\":\"Line\"},{\"attributes\":{\"source\":{\"id\":\"1553\"}},\"id\":\"1558\",\"type\":\"CDSView\"},{\"attributes\":{\"coordinates\":null,\"group\":null,\"items\":[{\"id\":\"1571\"},{\"id\":\"1591\"},{\"id\":\"1613\"}],\"location\":\"center_right\"},\"id\":\"1570\",\"type\":\"Legend\"},{\"attributes\":{\"line_alpha\":0.1,\"line_color\":\"#bdd7e7\",\"line_width\":2,\"x\":{\"field\":\"x\"},\"y\":{\"field\":\"y\"}},\"id\":\"1555\",\"type\":\"Line\"},{\"attributes\":{\"label\":{\"value\":\"n = 1\"},\"renderers\":[{\"id\":\"1557\"}]},\"id\":\"1571\",\"type\":\"LegendItem\"},{\"attributes\":{},\"id\":\"1623\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{},\"id\":\"1624\",\"type\":\"AllLabels\"},{\"attributes\":{\"ticker\":null},\"id\":\"1626\",\"type\":\"LogTickFormatter\"},{\"attributes\":{},\"id\":\"1627\",\"type\":\"AllLabels\"},{\"attributes\":{},\"id\":\"1503\",\"type\":\"PanTool\"},{\"attributes\":{\"args\":{\"p_act\":{\"id\":\"1486\"},\"p_rep\":{\"id\":\"1517\"}},\"code\":\"\\nif (p_act.visible == true) {\\n    p_act.visible = false;\\n    p_rep.visible = true;\\n}\\nelse {\\n    p_act.visible = true;\\n    p_rep.visible = false;\\n}\\n\"},\"id\":\"1552\",\"type\":\"CustomJS\"},{\"attributes\":{\"overlay\":{\"id\":\"1509\"}},\"id\":\"1505\",\"type\":\"BoxZoomTool\"},{\"attributes\":{},\"id\":\"1520\",\"type\":\"DataRange1d\"},{\"attributes\":{},\"id\":\"1628\",\"type\":\"UnionRenderers\"},{\"attributes\":{},\"id\":\"1504\",\"type\":\"WheelZoomTool\"},{\"attributes\":{\"axis\":{\"id\":\"1499\"},\"coordinates\":null,\"dimension\":1,\"group\":null,\"ticker\":null},\"id\":\"1502\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"1500\",\"type\":\"BasicTicker\"},{\"attributes\":{},\"id\":\"1629\",\"type\":\"Selection\"},{\"attributes\":{},\"id\":\"1506\",\"type\":\"SaveTool\"}],\"root_ids\":[\"1551\"]},\"title\":\"Bokeh Application\",\"version\":\"2.4.2\"}};\n",
       "  const render_items = [{\"docid\":\"06141408-a0d0-407f-a09b-320925ebff54\",\"root_ids\":[\"1551\"],\"roots\":{\"1551\":\"264f38d6-fadf-43d8-b73f-6d4d13621d7d\"}}];\n",
       "  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);\n",
       "\n",
       "  }\n",
       "  if (root.Bokeh !== undefined) {\n",
       "    embed_document(root);\n",
       "  } else {\n",
       "    let attempts = 0;\n",
       "    const timer = setInterval(function(root) {\n",
       "      if (root.Bokeh !== undefined) {\n",
       "        clearInterval(timer);\n",
       "        embed_document(root);\n",
       "      } else {\n",
       "        attempts++;\n",
       "        if (attempts > 100) {\n",
       "          clearInterval(timer);\n",
       "          console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\");\n",
       "        }\n",
       "      }\n",
       "    }, 10, root)\n",
       "  }\n",
       "})(window);"
      ],
      "application/vnd.bokehjs_exec.v0+json": ""
     },
     "metadata": {
      "application/vnd.bokehjs_exec.v0+json": {
       "id": "1551"
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Compute response functions\n",
    "x = np.logspace(-2, 2, 200)\n",
    "f_a = [x**n / (1 + x**n) for n in [1, 2, 10]]\n",
    "f_r = [1 - f for f in f_a]\n",
    "\n",
    "# Build plots\n",
    "p_act = bokeh.plotting.figure(\n",
    "    frame_height=225,\n",
    "    frame_width=350,\n",
    "    x_axis_label=\"x/k\",\n",
    "    y_axis_label=\"activating Hill function\",\n",
    "    x_range=[x[0], x[-1]],\n",
    "    x_axis_type=\"log\"\n",
    ")\n",
    "p_rep = bokeh.plotting.figure(\n",
    "    frame_height=225,\n",
    "    frame_width=350,\n",
    "    x_axis_label=\"x/k\",\n",
    "    y_axis_label=\"repressing Hill function\",\n",
    "    x_range=[x[0], x[-1]],\n",
    "    x_axis_type=\"log\"\n",
    ")\n",
    "\n",
    "# Set up toggling between activating and repressing\n",
    "p_act.visible = True\n",
    "p_rep.visible = False\n",
    "\n",
    "radio_button_group = bokeh.models.RadioButtonGroup(\n",
    "    labels=[\"activating\", \"repressing\"], active=0, width=100\n",
    ")\n",
    "col = bokeh.layouts.column(\n",
    "    p_act, p_rep, bokeh.layouts.row(bokeh.models.Spacer(width=145), radio_button_group)\n",
    ")\n",
    "radio_button_group.js_on_click(\n",
    "    bokeh.models.CustomJS(\n",
    "        args=dict(p_act=p_act, p_rep=p_rep),\n",
    "        code=\"\"\"\n",
    "if (p_act.visible == true) {\n",
    "    p_act.visible = false;\n",
    "    p_rep.visible = true;\n",
    "}\n",
    "else {\n",
    "    p_act.visible = true;\n",
    "    p_rep.visible = false;\n",
    "}\n",
    "\"\"\"))\n",
    "\n",
    "# Populate plots\n",
    "colors_act = bokeh.palettes.Blues5[1:-1][::-1]\n",
    "colors_rep = bokeh.palettes.Reds5[1:-1][::-1]\n",
    "\n",
    "for f_act, n, color in zip(f_a, [1, 2, 10], colors_act):\n",
    "    p_act.line(x, f_act, line_width=2, color=color, legend_label=f\"n = {n}\")\n",
    "\n",
    "for f_rep, n, color in zip(f_r, [1, 2, 10], colors_rep):\n",
    "    p_rep.line(x, f_rep, line_width=2, color=color, legend_label=f\"n = {n}\")\n",
    "\n",
    "p_act.legend.location = \"center_right\"\n",
    "p_rep.legend.location = \"center_right\"\n",
    "\n",
    "bokeh.io.show(col)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Activator vs. Repressor—which to choose?\n",
    "\n",
    "*And now at last we have reached our first true \"design\" question:* The cell has at least two different ways to regulate a gene: using an activator or using a repressor. Which should it choose? Which would you choose if you were designing a synthetic circuit? Why? Are they completely equivalent ways to regulate a target gene? Is one better in some or all conditions? How could we know?  \n",
    "\n",
    "In particular, if we were to design a gene regulation system to turn on in the presence of a specific target molecule (we will call this the **inducer**), then we could design the gene to be regulated by an activator whose activity is turned on by the inducer (see left figure below), or alternatively, to be regulated by a repressor whose activity is turned off by the inducer (see right figure below). At first glance, these architectures may look equivalent in their output, but is that really the case?\n",
    "\n",
    "\n",
    "<div style=\"width: 350px; margin: auto;\">\n",
    "\n",
    "![equivalent systems](figs/equivalent_systems.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "Michael Savageau posed these question in the context of bacterial metabolic gene regulation in his paper, \"Design of molecular control mechanisms and the demand for gene expression\" ([_PNAS_, 1977](https://www.ncbi.nlm.nih.gov/pubmed/271992)). He focused on \"demand\" as a critical factor that influences the choice of activation or repression. *Demand* can be defined as the fraction of time that the gene is needed at the high end of its regulatory range in the cells natural environments. Savageau made the empirical observation that high-demand genes are more frequently regulated by activators, while low-demand genes are more often regulated by repressors. \n",
    "\n",
    "<div style=\"width: 500px; margin: auto;\">\n",
    "\n",
    "![low demand, high demand](figs/low_demand-high_demand3.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "He suggested that this relationship could be explained by a **\"use it or lose it\"** rule of evolutionary selection. Recall that mutations, especially those that diminish the function of a gene, occur frequently. A high demand gene controlled by an activator needs the activator to be on most of the time. Under these conditions, evolution would select against mutations that eliminate the activator. By contrast, if the same high demand system were regulated by a repressor then, most of the time, there would be weaker selection against mutations that removed the repressor, increasing the potential for evolutionary loss of the regulatory system. This reasoning assumes no direct fitness advantage for either regulation mode, just a difference in the average strength of selection pressure needed to maintain them.\n",
    "\n",
    "In 2009, [Gerland and Hwa](https://dx.doi.org/10.1073%2Fpnas.0808500106) formulated and analyzed a model to explore these ideas mathematically. They showed that the \"use it or lose it\" principle indeed dominates when timescales of switching between low and high demand environments are long and populations are small. However, the same model could select for the opposite demand rule in other regimes. \n",
    "\n",
    "[Shinar, et al.](https://doi.org/10.1073/pnas.0506610103) introduced a different explanation for the demand rules. The authors assumed that \"naked\" DNA binding sites, which are not bound to proteins, are susceptible to non-specific binding of transcription factors. These inadvertent encounters between transcription factors and DNA could lead to inappropriate activation or repression of adjacent genes, imposing a low, but non-zero fitness cost. \"Intentionally\" keeping these sites occupied most of the time minimizes the fraction of time that such events can occur. \n",
    "\n",
    "This explanation make the same predictions as Savageau's explanation but for different reasons. Here, a high demand gene should preferentially use an activator since this arrangement minimizes unoccupied binding sites more of the time. Conversely, a low demand gene would preferentially use repression to maintain the binding site in an occupied state under most conditions. This argument can be generalized to other examples of seemingly equivalent regulatory systems and is described in [Uri Alon's book](https://www.amazon.com/gp/product/1439837171/ref=dbs_a_def_rwt_bibl_vppi_i0). \n",
    "\n",
    "<div style=\"width: 250px; margin: auto;\">\n",
    "\n",
    "![Error load](figs/ErrorLoad.png)\n",
    "\n",
    "</div>\n",
    "\n",
    "*In this figure, a repressor, denoted R binds strongly and specifically to its target site. In the absence o the repressor, that site could also be bound non-specifically, and inappropriately by a range of other factors, denoted A-F.*\n",
    "\n",
    "Remarkably, we still lack definitive experimental evidence to fully resolve this fundamental design question. As a challenge in the end-of-chapter problems, you are aked to devise an experimental way to discriminate among these potential explanations."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "tags": [
     "remove_cell"
    ]
   },
   "source": [
    "<hr>\n",
    "\n",
    "## Computing environment\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Python implementation: CPython\n",
      "Python version       : 3.9.7\n",
      "IPython version      : 8.1.1\n",
      "\n",
      "numpy     : 1.20.3\n",
      "bokeh     : 2.4.2\n",
      "jupyterlab: 3.3.2\n",
      "\n"
     ]
    }
   ],
   "source": [
    "%load_ext watermark\n",
    "%watermark -v -p numpy,bokeh,jupyterlab"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "tags": []
   },
   "source": [
    "<hr>\n",
    "\n",
    "## Problems"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbsphinx-toctree": {},
    "tags": []
   },
   "source": [
    "- [1.1: Strategies for controlling protein expression](../problems/01/problem_1.1.ipynb)\n",
    "- [1.2: Separation of time scales](../problems/01/problem_1.2.ipynb)\n",
    "- [1.3: Rate of production of gene product by an activator](../problems/01/problem_1.3.ipynb)\n",
    "- [1.4: Activators vs. repressors](../problems/01/problem_1.4.ipynb)\n",
    "- [1.5: Bound and unbound promoter regions](../problems/01/problem_1.5.ipynb)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  },
  "varInspector": {
   "cols": {
    "lenName": 16,
    "lenType": 16,
    "lenVar": 40
   },
   "kernels_config": {
    "python": {
     "delete_cmd_postfix": "",
     "delete_cmd_prefix": "del ",
     "library": "var_list.py",
     "varRefreshCmd": "print(var_dic_list())"
    },
    "r": {
     "delete_cmd_postfix": ") ",
     "delete_cmd_prefix": "rm(",
     "library": "var_list.r",
     "varRefreshCmd": "cat(var_dic_list()) "
    }
   },
   "types_to_exclude": [
    "module",
    "function",
    "builtin_function_or_method",
    "instance",
    "_Feature"
   ],
   "window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
